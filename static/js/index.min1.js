"use strict";function _instanceof(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function _defineProperty(e,t,i){return t=_toPropertyKey(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var n=_superPropBase(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(arguments.length<3?e:i):r.value}},_get.apply(this,arguments)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&(e=_getPrototypeOf(e),null!==e););return e}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classCallCheck(e,t){if(!_instanceof(e,t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var i,n=_getPrototypeOf(e);if(t){var r=_getPrototypeOf(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return _possibleConstructorReturn(this,i)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(e){function i(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(i,e)},_wrapNativeSuper(e)}function _construct(e,t,i){return _construct=_isNativeReflectConstruct()?Reflect.construct.bind():function(e,t,i){var n=[null];n.push.apply(n,t);var r=Function.bind.apply(e,n),o=new r;return i&&_setPrototypeOf(o,i.prototype),o},_construct.apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var n,r,o,a,s=[],l=!0,c=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(n=o.call(i)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){c=!0,r=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(c)throw r}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _createForOfIteratorHelper(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var n=0,r=function(){};return{s:r,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}(function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],t):(e="undefined"!=typeof globalThis?globalThis:e||self,t(e.PhotoSphereViewer={},e.THREE))})(window,function(e,t){function i(e,t){var i=e%t;return i<0&&(i+=t),i}function n(e){return e.reduce(function(e,t){return e+t},0)}function r(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function o(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}function a(e,t){var i=[0,2*Math.PI,2*-Math.PI];return i.reduce(function(i,n){var r=t-e+n;return Math.abs(r)<Math.abs(i)?r:i},1/0)}function s(e,t){return Math.acos(Math.cos(e.pitch)*Math.cos(t.pitch)*Math.cos(e.yaw-t.yaw)+Math.sin(e.pitch)*Math.sin(t.pitch))}function l(e,t){var i=_slicedToArray(e,2),n=i[0],r=i[1],o=_slicedToArray(t,2),a=o[0],s=o[1],l=(a-n)*Math.cos((r+s)/2),c=s-r;return Math.sqrt(l*l+c*c)}function c(e){return"string"==typeof e?e.match(/^[a-z]/i)?document.getElementById(e):document.querySelector(e):e}function u(e,t,i){void 0===i?e.classList.toggle(t):i?e.classList.add(t):i||e.classList.remove(t)}function h(e,t){var i;(i=e.classList).add.apply(i,_toConsumableArray(t.split(" ")))}function d(e,t){var i;(i=e.classList).remove.apply(i,_toConsumableArray(t.split(" ")))}function v(e,t){var i=e;do{if(i===t)return!0;i=i.parentElement}while(i);return!1}function p(e,t){if(null==e||!e.matches)return null;var i=e;do{if(i.matches(t))return i;i=i.parentElement}while(i);return null}function f(e){for(var t=0,i=0,n=e;n;)t+=n.offsetLeft-n.scrollLeft+n.clientLeft,i+=n.offsetTop-n.scrollTop+n.clientTop,n=n.offsetParent;return{x:t,y:i}}function y(e,t){return window.getComputedStyle(e,null)[t]}function m(e){if(e.touches.length<2)return null;var t={x:e.touches[0].clientX,y:e.touches[0].clientY},i={x:e.touches[1].clientX,y:e.touches[1].clientY};return{distance:r(t,i),angle:o(t,i),center:{x:(t.x+i.x)/2,y:(t.y+i.y)/2}}}function g(e){return(document.fullscreenElement||document.webkitFullscreenElement)===e}function _(e){(e.requestFullscreen||e.webkitRequestFullscreen).call(e)}function w(){(document.exitFullscreen||document.webkitExitFullscreen).call(document)}function b(e){return e.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,function(e,t){return(t>0?"-":"")+e.toLowerCase()})}function k(e,t){var i=!1;return function(){for(var n=this,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];i||(i=!0,setTimeout(function(){e.apply(n,o),i=!1},t))}}function E(e){if("object"!==_typeof(e)||null===e||"[object Object]"!==Object.prototype.toString.call(e))return!1;if(null===Object.getPrototypeOf(e))return!0;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function C(e,t){var i=t;return function e(t,n){return Array.isArray(n)?(t&&Array.isArray(t)?t.length=0:t=[],n.forEach(function(i,n){t[n]=e(null,i)})):"object"===_typeof(n)?(t&&!Array.isArray(t)||(t={}),Object.keys(n).forEach(function(r){"object"===_typeof(n[r])&&n[r]&&E(n[r])?n[r]!==i&&(t[r]?e(t[r],n[r]):t[r]=e(null,n[r])):t[r]=n[r]})):t=n,t}(e,t)}function T(e){return C(null,e)}function S(e){return!e||0===Object.keys(e).length&&e.constructor===Object}function P(e){return null==e}function O(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var n=0,r=t;n<r.length;n++){var o=r[n];if(!P(o))return o}return null}function M(e,t){if(e===t)return!0;if(L(e)&&L(t)){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];if(!M(e[r],t[r]))return!1}return!0}return!1}function L(e){return"object"===_typeof(e)&&null!==e}function x(e,t){E(e)?(t(e.initial,!0),e.promise.then(function(e){return t(e,!1)})):t(e,!0)}function I(e){return{initial:!e.initial,promise:e.promise.then(function(e){return!e})}}function z(){var e=new Error("Loading was aborted.");return e.name="AbortError",e}function A(e){return"AbortError"===(null==e?void 0:e.name)}function R(e){console.warn("PhotoSphereViewer: ".concat(e))}function H(e){return!!e&&[["textureX","textureY"],["yaw","pitch"]].some(function(t){var i=_slicedToArray(t,2),n=i[0],r=i[1];return void 0!==e[n]&&void 0!==e[r]})}function N(e,t){var i=e.match("<GPano:"+t+">(.*)</GPano:"+t+">");if(null!==i){var n=parseInt(i[1],10);return isNaN(n)?null:n}if(i=e.match("GPano:"+t+'="(.*?)"'),null!==i){var r=parseInt(i[1],10);return isNaN(r)?null:r}return null}function V(e){if(!e)return{x:.5,y:.5};if("object"===_typeof(e))return e;var t=e.toLocaleLowerCase().split(" ").slice(0,2);1===t.length&&(t=Ne[t[0]]?[t[0],Ue]:[t[0],t[0]]);var i="left"!==t[1]&&"right"!==t[1]&&"top"!==t[0]&&"bottom"!==t[0];t=t.map(function(e){return Ne[e]||e}),i||t.reverse();var n=t.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return n?{x:parseFloat(n[1])/100,y:parseFloat(n[2])/100}:{x:.5,y:.5}}function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{allowCenter:!0,cssOrder:!0},i=t.allowCenter,n=t.cssOrder;return e?("string"==typeof e&&(e=e.split(" ")),1===e.length&&(e[0]===Ue?e=[Ue,Ue]:-1!==Ve.indexOf(e[0])?e=[Ue,e[0]]:-1!==De.indexOf(e[0])&&(e=[e[0],Ue])),2!==e.length||-1===je.indexOf(e[0])||-1===je.indexOf(e[1])?(R("Unparsable position ".concat(e)),null):i||e[0]!==Ue||e[1]!==Ue?(n&&!j(e)&&(e=[e[1],e[0]]),e[1]===Ue&&-1!==Ve.indexOf(e[0])&&(e=[Ue,e[0]]),e[0]===Ue&&-1!==De.indexOf(e[1])&&(e=[e[1],Ue]),e):(R("Invalid position center center"),null)):null}function j(e){return-1!==De.indexOf(e[0])&&-1!==Ve.indexOf(e[1])}function U(e){var t;if("string"==typeof e){var i=e.toString().trim(),n=parseFloat(i.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),r=i.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(r.match(/(pm|per minute)$/)&&(n/=60),r){case"dpm":case"degrees per minute":case"dps":case"degrees per second":t=Re.MathUtils.degToRad(n);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":t=n;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":t=n*Math.PI*2;break;default:throw new He('Unknown speed unit "'.concat(r,'"'))}}else t=e;return t}function F(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;if("string"==typeof e){var o=e.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!o)throw new He('Unknown angle "'.concat(e,'"'));var a=parseFloat(o[1]),s=o[2];if(s)switch(s){case"deg":case"degs":t=Re.MathUtils.degToRad(a);break;case"rad":case"rads":t=a;break;default:throw new He('Unknown angle unit "'.concat(s,'"'))}else t=a}else{if("number"!=typeof e||isNaN(e))throw new He('Unknown angle "'.concat(e,'"'));t=e}return t=i(n?t+Math.PI:t,2*Math.PI),n?Re.MathUtils.clamp(t-Math.PI,-Math.PI/(r?2:1),Math.PI/(r?2:1)):t}function W(e){var t=new Re.Texture(e);return t.needsUpdate=!0,t.minFilter=Re.LinearFilter,t.generateMipmaps=!1,t}function Y(e,t){Fe.setFromEuler(t).invert(),e.applyQuaternion(Fe)}function B(e,t){var i=function(i){if(!i)return T(e);for(var n=T({...e,...i}),r={},o=0,a=Object.entries(n);o<a.length;o++){var s=_slicedToArray(a[o],2),l=s[0],c=s[1];if(t&&l in t)c=t[l](c,{rawConfig:n,defValue:e[l]});else if(!(l in e)){R("Unknown option ".concat(l));continue}r[l]=c}return r};return i.defaults=e,i.parsers=t||{},i}function X(e){if(e)for(var t=0,i=[["_",e]].concat(_toConsumableArray(Object.entries(e)));t<i.length;t++){var n=_slicedToArray(i[t],2),r=n[1];if(_instanceof(r.prototype,ni))return r}return null}function Z(){var e=document.createElement("canvas"),t=["webgl2","webgl","experimental-webgl","moz-webgl","webkit-3d"],i=null;return e.getContext&&t.some(function(t){try{return i=e.getContext(t),null!==i}catch(e){return!1}})?i:null}function q(){var e="ontouchstart"in window||navigator.maxTouchPoints>0;oi in localStorage&&(e="true"===localStorage[oi]);var t=new Promise(function(t){var i=function(){window.removeEventListener("mousedown",n),window.removeEventListener("touchstart",r),clearTimeout(a)},n=function(){i(),localStorage[oi]=!1,t(!1)},r=function(){i(),localStorage[oi]=!0,t(!0)},o=function(){i(),localStorage[oi]=e,t(e)};window.addEventListener("mousedown",n,!1),window.addEventListener("touchstart",r,!1);var a=setTimeout(o,1e4)});return{initial:e,promise:t}}function K(e){var t=document.createElement("canvas"),i=t.getContext("2d");for(t.width=e,t.height=e/2;t.width>1024;){i.fillStyle="white",i.fillRect(0,0,1,1);try{if(i.getImageData(0,0,1,1).data[0]>0)return t.width}catch(e){}t.width/=2,t.height/=2}throw new He("Unable to detect system capabilities")}function G(){return"exitFullscreen"in document?"fullscreenchange":"webkitExitFullscreen"in document?"webkitfullscreenchange":null}function Q(e){var t=0;switch(e){case 0:t=90;break;case 1:t=-90;break;case 3:t=180;break;default:t=0}return Ie.arrow.replace("rotate(0","rotate(".concat(t))}function $(e){if(e)for(var t=0,i=[["_",e]].concat(_toConsumableArray(Object.entries(e)));t<i.length;t++){var n=_slicedToArray(i[t],2),r=n[1];if(_instanceof(r.prototype,Mi))return r}return null}function J(e,t){if(!e.id)throw new He("Button id is required");if(Hi[e.id]=e,e.groupId&&(Ni[e.groupId]=Ni[e.groupId]||[]).push(e),t){var i=xi.navbar;switch(t){case"start":i.unshift(e.id);break;case"end":i.push(e.id);break;default:var n=t.split(":"),r=_slicedToArray(n,2),o=r[0],a=r[1],s=i.indexOf(o);if(!o||!a||-1===s)throw new He("Invalid defaultPosition ".concat(t));i.splice(s+("right"===a?1:0),0,e.id)}}}var ee,te=Object.defineProperty,ie=Object.getOwnPropertyDescriptor,ne=Object.getOwnPropertyNames,re=Object.prototype.hasOwnProperty,oe=function(e,t){for(var i in t)te(e,i,{get:t[i],enumerable:!0})},ae=function(e,t,i,n){if(t&&"object"===_typeof(t)||"function"==typeof t){var r,o=_createForOfIteratorHelper(ne(t));try{var a=function(){var o=r.value;re.call(e,o)||o===i||te(e,o,{get:function(){return t[o]},enumerable:!(n=ie(t,o))||n.enumerable})};for(o.s();!(r=o.n()).done;)a()}catch(e){o.e(e)}finally{o.f()}}return e},se=function(){return t},le={};oe(le,{AbstractAdapter:function(){return ni},AbstractButton:function(){return hi},AbstractComponent:function(){return ci},AbstractConfigurablePlugin:function(){return Li},AbstractPlugin:function(){return Mi},CONSTANTS:function(){return ce},DEFAULTS:function(){return xi},EquirectangularAdapter:function(){return li},PSVError:function(){return He},SYSTEM:function(){return ai},TypedEvent:function(){return Qe},Viewer:function(){return dn},events:function(){return Ge},registerButton:function(){return J},utils:function(){return Ae}});var ce={};oe(ce,{ACTIONS:function(){return Me},ANIMATION_MIN_DURATION:function(){return we},CTRLZOOM_TIMEOUT:function(){return Te},DBLCLICK_DELAY:function(){return ke},DEFAULT_TRANSITION:function(){return _e},EASINGS:function(){return ze},ICONS:function(){return Ie},IDS:function(){return Le},INERTIA_WINDOW:function(){return Se},KEY_CODES:function(){return xe},LONGTOUCH_DELAY:function(){return Ee},MOVE_THRESHOLD:function(){return be},SPHERE_RADIUS:function(){return Pe},TWOFINGERSOVERLAY_DELAY:function(){return Ce},VIEWER_DATA:function(){return Oe}});var ue='<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g><!-- Created by Flatart from the Noun Project --></svg>\n',he='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',de='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/><!--Created by Michael Zenaty from the Noun Project--></svg>\n',ve='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/><!--Created by Garrett Knoll from the Noun Project--></svg>\n',pe='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/><!--Created by Garrett Knoll from the Noun Project--></svg>\n',fe='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/><!--Created by Arafat Uddin from the Noun Project--></svg>\n',ye='<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g><!-- Created by Richard Kunák from the Noun Project--></svg>\n',me='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/><!--Created by Ryan Canning from the Noun Project--></svg>\n',ge='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/><!--Created by Ryan Canning from the Noun Project--></svg>\n',_e=1500,we=500,be=4,ke=300,Ee=500,Ce=100,Te=2e3,Se=300,Pe=10,Oe="photoSphereViewer",Me=function(e){return e.ROTATE_UP="ROTATE_UP",e.ROTATE_DOWN="ROTATE_DOWN",e.ROTATE_RIGHT="ROTATE_RIGHT",e.ROTATE_LEFT="ROTATE_LEFT",e.ZOOM_IN="ZOOM_IN",e.ZOOM_OUT="ZOOM_OUT",e}(Me||{}),Le={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},xe={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},Ie={arrow:ue,close:he,download:de,fullscreenIn:ve,fullscreenOut:pe,info:fe,menu:ye,zoomIn:me,zoomOut:ge},ze={linear:function(e){return e},inQuad:function(e){return e*e},outQuad:function(e){return e*(2-e)},inOutQuad:function(e){return e<.5?2*e*e:(4-2*e)*e-1},inCubic:function(e){return e*e*e},outCubic:function(e){return--e*e*e+1},inOutCubic:function(e){return e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1},inQuart:function(e){return e*e*e*e},outQuart:function(e){return 1- --e*e*e*e},inOutQuart:function(e){return e<.5?8*e*e*e*e:1-8*--e*e*e*e},inQuint:function(e){return e*e*e*e*e},outQuint:function(e){return 1+--e*e*e*e*e},inOutQuint:function(e){return e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e},inSine:function(e){return 1-Math.cos(e*(Math.PI/2))},outSine:function(e){return Math.sin(e*(Math.PI/2))},inOutSine:function(e){return.5-.5*Math.cos(Math.PI*e)},inExpo:function(e){return Math.pow(2,10*(e-1))},outExpo:function(e){return 1-Math.pow(2,-10*e)},inOutExpo:function(e){return(e=2*e-1)<0?.5*Math.pow(2,10*e):1-.5*Math.pow(2,-10*e)},inCirc:function(e){return 1-Math.sqrt(1-e*e)},outCirc:function(e){return Math.sqrt(1-(e-1)*(e-1))},inOutCirc:function(e){return(e*=2)<1?.5-.5*Math.sqrt(1-e*e):.5+.5*Math.sqrt(1-(e-=2)*e)}},Ae={};oe(Ae,{Animation:function(){return We},Dynamic:function(){return Be},MultiDynamic:function(){return Xe},PressHandler:function(){return Ze},Slider:function(){return Ke},SliderDirection:function(){return qe},addClasses:function(){return h},angle:function(){return o},applyEulerInverse:function(){return Y},cleanCssPosition:function(){return D},clone:function(){return T},createTexture:function(){return W},cssPositionIsOrdered:function(){return j},dasherize:function(){return b},deepEqual:function(){return M},deepmerge:function(){return C},distance:function(){return r},exitFullscreen:function(){return w},firstNonNull:function(){return O},getAbortError:function(){return z},getAngle:function(){return s},getClosest:function(){return p},getConfigParser:function(){return B},getElement:function(){return c},getPosition:function(){return f},getShortestArc:function(){return a},getStyle:function(){return y},getTouchData:function(){return m},getXMPValue:function(){return N},greatArcDistance:function(){return l},hasParent:function(){return v},invertResolvableBoolean:function(){return I},isAbortError:function(){return A},isEmpty:function(){return S},isExtendedPosition:function(){return H},isFullscreenEnabled:function(){return g},isNil:function(){return P},isPlainObject:function(){return E},logWarn:function(){return R},parseAngle:function(){return F},parsePoint:function(){return V},parseSpeed:function(){return U},removeClasses:function(){return d},requestFullscreen:function(){return _},resolveBoolean:function(){return x},sum:function(){return n},throttle:function(){return k},toggleClass:function(){return u},wrap:function(){return i}});var Re=se(),He=function(e){function t(e){var n,r;return _classCallCheck(this,t),r=i.call(this,e),r.name="PSVError",null===(n=Error.captureStackTrace)||void 0===n||n.call(Error,_assertThisInitialized(r),t),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(_wrapNativeSuper(Error)),Ne={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Ve=["left","center","right"],De=["top","center","bottom"],je=[].concat(Ve,De),Ue="center",Fe=new Re.Quaternion,We=function(){function e(t){var i=this;_classCallCheck(this,e),this.easing=ze.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=t,t?(t.easing&&(this.easing="function"==typeof t.easing?t.easing:ze[t.easing]||ze.linear),this.delayTimeout=setTimeout(function(){i.delayTimeout=void 0,i.animationFrame=window.requestAnimationFrame(function(e){return i.__run(e)})},t.delay||0)):this.resolved=!0}return _createClass(e,[{key:"__run",value:function(e){var t=this;if(!this.cancelled){this.start||(this.start=e);var i=(e-this.start)/this.options.duration,n={};if(i<1){for(var r=0,o=Object.entries(this.options.properties);r<o.length;r++){var a=_slicedToArray(o[r],2),s=a[0],l=a[1];if(l){var c=l.start+(l.end-l.start)*this.easing(i);n[s]=c}}this.options.onTick(n,i),this.animationFrame=window.requestAnimationFrame(function(e){return t.__run(e)})}else{for(var u=0,h=Object.entries(this.options.properties);u<h.length;u++){var d=_slicedToArray(h[u],2),v=d[0],p=d[1];p&&(n[v]=p.end)}this.options.onTick(n,1),this.__resolve(!0),this.animationFrame=void 0}}}},{key:"__resolve",value:function(e){e?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach(function(t){return t(e)}),this.callbacks.length=0}},{key:"then",value:function(e){var t=this;return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(e):new Promise(function(e){t.callbacks.push(e)}).then(e)}},{key:"cancel",value:function(){this.cancelled||this.resolved||(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}}]),e}(),Ye=se(),Be=function(){function e(t,i){if(_classCallCheck(this,e),this.fn=t,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=i.min,this.max=i.max,this.wrap=i.wrap,this.current=i.defaultValue,this.wrap&&0!==this.min)throw new He("invalid config");this.fn&&this.fn(this.current)}return _createClass(e,[{key:"current",get:function(){return this.__current},set:function(e){this.__current=e}},{key:"setSpeed",value:function(e){this.speed=e}},{key:"goto",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.mode=2,this.target=this.wrap?i(e,this.max):Ye.MathUtils.clamp(e,this.min,this.max),this.speedMult=t}},{key:"step",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;0===t?this.setValue(this.current+e):(2!==this.mode&&(this.target=this.current),this.goto(this.target+e,t))}},{key:"roll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.mode=1,this.target=e?-1/0:1/0,this.speedMult=t}},{key:"stop",value:function(){this.mode=0}},{key:"setValue",value:function(e){return this.target=this.wrap?i(e,this.max):Ye.MathUtils.clamp(e,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current&&(this.current=this.target,this.fn&&this.fn(this.current),!0)}},{key:"update",value:function(e){if(2===this.mode){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);var t=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=t&&(this.mode=0)}var n=0===this.mode?0:this.speed*this.speedMult;this.target<this.current&&(n=-n),this.currentSpeed<n?this.currentSpeed=Math.min(n,this.currentSpeed+e/1e3*this.speed*this.speedMult*2):this.currentSpeed>n&&(this.currentSpeed=Math.max(n,this.currentSpeed-e/1e3*this.speed*this.speedMult*2));var r=null;return this.current>this.target&&this.currentSpeed?r=Math.max(this.target,this.current+this.currentSpeed*e/1e3):this.current<this.target&&this.currentSpeed&&(r=Math.min(this.target,this.current+this.currentSpeed*e/1e3)),null!==r&&(r=this.wrap?i(r,this.max):Ye.MathUtils.clamp(r,this.min,this.max),r!==this.current)&&(this.current=r,this.fn&&this.fn(this.current),!0)}}]),e}(),Xe=function(){function e(t,i){_classCallCheck(this,e),this.fn=t,this.dynamics=i,this.fn&&this.fn(this.current)}return _createClass(e,[{key:"current",get:function(){return Object.entries(this.dynamics).reduce(function(e,t){var i=_slicedToArray(t,2),n=i[0],r=i[1];return e[n]=r.current,e},{})}},{key:"setSpeed",value:function(e){for(var t=0,i=Object.values(this.dynamics);t<i.length;t++){var n=i[t];n.setSpeed(e)}}},{key:"goto",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=0,n=Object.entries(e);i<n.length;i++){var r=_slicedToArray(n[i],2),o=r[0],a=r[1];this.dynamics[o].goto(a,t)}}},{key:"step",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(0===i)this.setValue(Object.keys(e).reduce(function(i,n){return i[n]=e[n]+t.dynamics[n].current,i},{}));else for(var n=0,r=Object.entries(e);n<r.length;n++){var o=_slicedToArray(r[n],2),a=o[0],s=o[1];this.dynamics[a].step(s,i)}}},{key:"roll",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=0,n=Object.entries(e);i<n.length;i++){var r=_slicedToArray(n[i],2),o=r[0],a=r[1];this.dynamics[o].roll(a,t)}}},{key:"stop",value:function(){for(var e=0,t=Object.values(this.dynamics);e<t.length;e++){var i=t[e];i.stop()}}},{key:"setValue",value:function(e){for(var t=!1,i=0,n=Object.entries(e);i<n.length;i++){var r=_slicedToArray(n[i],2),o=r[0],a=r[1];t=this.dynamics[o].setValue(a)||t}return t&&this.fn&&this.fn(this.current),t}},{key:"update",value:function(e){for(var t=!1,i=0,n=Object.values(this.dynamics);i<n.length;i++){var r=n[i];t=r.update(e)||t}return t&&this.fn&&this.fn(this.current),t}}]),e}(),Ze=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;_classCallCheck(this,e),this.delay=t,this.time=0,this.delay=t}return _createClass(e,[{key:"pending",get:function(){return 0!==this.time}},{key:"down",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=(new Date).getTime()}},{key:"up",value:function(e){var t=this;if(this.time){var i=Date.now()-this.time;i<this.delay?this.timeout=setTimeout(function(){e(),t.timeout=void 0,t.time=0},this.delay):(e(),this.time=0)}}}]),e}(),qe=function(e){return e.VERTICAL="VERTICAL",e.HORIZONTAL="HORIZONTAL",e}(qe||{}),Ke=function(){function e(t,i,n){_classCallCheck(this,e),this.container=t,this.direction=i,this.listener=n,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),
window.addEventListener("touchend",this)}return _createClass(e,[{key:"isVertical",get:function(){return"VERTICAL"===this.direction}},{key:"isHorizontal",get:function(){return"HORIZONTAL"===this.direction}},{key:"destroy",value:function(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}},{key:"handleEvent",value:function(e){switch(e.type){case"click":e.stopPropagation();break;case"mousedown":this.__onMouseDown(e);break;case"mouseenter":this.__onMouseEnter(e);break;case"mouseleave":this.__onMouseLeave(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e)}}},{key:"__onMouseDown",value:function(e){this.mousedown=!0,this.__update(e.clientX,e.clientY,!0)}},{key:"__onMouseEnter",value:function(e){this.mouseover=!0,this.__update(e.clientX,e.clientY,!0)}},{key:"__onTouchStart",value:function(e){this.mouseover=!0,this.mousedown=!0;var t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}},{key:"__onMouseMove",value:function(e){(this.mousedown||this.mouseover)&&(e.stopPropagation(),this.__update(e.clientX,e.clientY,!0))}},{key:"__onTouchMove",value:function(e){if(this.mousedown||this.mouseover){e.stopPropagation();var t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!0)}}},{key:"__onMouseUp",value:function(e){this.mousedown&&(this.mousedown=!1,this.__update(e.clientX,e.clientY,!1))}},{key:"__onMouseLeave",value:function(e){this.mouseover&&(this.mouseover=!1,this.__update(e.clientX,e.clientY,!0))}},{key:"__onTouchEnd",value:function(e){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;var t=e.changedTouches[0];this.__update(t.clientX,t.clientY,!1)}}},{key:"__update",value:function(e,t,i){var n=this.container.getBoundingClientRect(),r=this.isVertical?t:e,o=n[this.isVertical?"bottom":"left"],a=n[this.isVertical?"height":"width"],s=Math.abs((o-r)/a);this.listener({value:s,click:!i,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:e,clientY:t}})}}]),e}(),Ge={};oe(Ge,{BeforeAnimateEvent:function(){return tt},BeforeRenderEvent:function(){return nt},BeforeRotateEvent:function(){return ot},ClickEvent:function(){return st},ConfigChangedEvent:function(){return ct},DoubleClickEvent:function(){return ht},FullscreenEvent:function(){return vt},HideNotificationEvent:function(){return ft},HideOverlayEvent:function(){return mt},HidePanelEvent:function(){return _t},HideTooltipEvent:function(){return bt},KeypressEvent:function(){return Et},LoadProgressEvent:function(){return Tt},ObjectEnterEvent:function(){return Gt},ObjectEvent:function(){return qt},ObjectHoverEvent:function(){return ei},ObjectLeaveEvent:function(){return $t},PanoramaLoadedEvent:function(){return Pt},PositionUpdatedEvent:function(){return Mt},ReadyEvent:function(){return xt},RenderEvent:function(){return zt},ShowNotificationEvent:function(){return Rt},ShowOverlayEvent:function(){return Nt},ShowPanelEvent:function(){return Dt},ShowTooltipEvent:function(){return Ut},SizeUpdatedEvent:function(){return Wt},StopAllEvent:function(){return Bt},ViewerEvent:function(){return Je},ZoomUpdatedEvent:function(){return Zt}});var Qe=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return _classCallCheck(this,t),i.call(this,e,{cancelable:n})}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(_wrapNativeSuper(Event)),$e=function(e){function t(){return _classCallCheck(this,t),i.apply(this,arguments)}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"dispatchEvent",value:function(e){return _get(_getPrototypeOf(t.prototype),"dispatchEvent",this).call(this,e)}},{key:"addEventListener",value:function(e,i,n){_get(_getPrototypeOf(t.prototype),"addEventListener",this).call(this,e,i,n)}},{key:"removeEventListener",value:function(e,i,n){_get(_getPrototypeOf(t.prototype),"removeEventListener",this).call(this,e,i,n)}}]),t}(_wrapNativeSuper(EventTarget)),Je=function(e){function t(){return _classCallCheck(this,t),i.apply(this,arguments)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Qe),et=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,t.type,!0),r.position=e,r.zoomLevel=n,r}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),tt=et;tt.type="before-animate";var it=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,t.type),r.timestamp=e,r.elapsed=n,r}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),nt=it;nt.type="before-render";var rt=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type,!0),n.position=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),ot=rt;ot.type="before-rotate";var at=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.data=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),st=at;st.type="click";var lt=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.options=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"containsOptions",value:function(){for(var e=this,t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.some(function(t){return e.options.includes(t)})}}]),t}(Je),ct=lt;ct.type="config-changed";var ut=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.data=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),ht=ut;ht.type="dblclick";var dt=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.fullscreenEnabled=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),vt=dt;vt.type="fullscreen";var pt=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.notificationId=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),ft=pt;ft.type="hide-notification";var yt=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.overlayId=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),mt=yt;mt.type="hide-overlay";var gt=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.panelId=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),_t=gt;_t.type="hide-panel";var wt=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.tooltipData=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),bt=wt;bt.type="hide-tooltip";var kt=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type,!0),n.key=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Et=kt;Et.type="key-press";var Ct=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.progress=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Tt=Ct;Tt.type="load-progress";var St=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.data=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Pt=St;Pt.type="panorama-loaded";var Ot=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.position=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Mt=Ot;Mt.type="position-updated";var Lt=function(e){function t(){return _classCallCheck(this,t),i.call(this,t.type)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),xt=Lt;xt.type="ready";var It=function(e){function t(){return _classCallCheck(this,t),i.call(this,t.type)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),zt=It;zt.type="render";var At=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.notificationId=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Rt=At;Rt.type="show-notification";var Ht=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.overlayId=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Nt=Ht;Nt.type="show-overlay";var Vt=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.panelId=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Dt=Vt;Dt.type="show-panel";var jt=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,t.type),r.tooltip=e,r.tooltipData=n,r}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Ut=jt;Ut.type="show-tooltip";var Ft=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.size=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Wt=Ft;Wt.type="size-updated";var Yt=function(e){function t(){return _classCallCheck(this,t),i.call(this,t.type)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Bt=Yt;Bt.type="stop-all";var Xt=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.zoomLevel=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Zt=Xt;Zt.type="zoom-updated";var qt=function(e){function t(e,n,r,o,a){var s;return _classCallCheck(this,t),s=i.call(this,e),s.originalEvent=n,s.object=r,s.viewerPoint=o,s.userDataKey=a,s}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Je),Kt=function(e){function t(e,n,r,o){return _classCallCheck(this,t),i.call(this,t.type,e,n,r,o)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(qt),Gt=Kt;Gt.type="enter-object";var Qt=function(e){function t(e,n,r,o){return _classCallCheck(this,t),i.call(this,t.type,e,n,r,o)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(qt),$t=Qt;$t.type="leave-object";var Jt=function(e){function t(e,n,r,o){return _classCallCheck(this,t),i.call(this,t.type,e,n,r,o)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(qt),ei=Jt;ei.type="hover-object";var ti=se(),ii=function(){function e(t){_classCallCheck(this,e),this.viewer=t}return _createClass(e,[{key:"destroy",value:function(){}},{key:"supportsTransition",value:function(e){return!1}},{key:"supportsPreload",value:function(e){return!1}}],[{key:"createOverlayMaterial",value:function(){var t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(i.additionalUniforms,i.overrideVertexShader);return new ti.ShaderMaterial({uniforms:(t={},_defineProperty(t,e.OVERLAY_UNIFORMS.panorama,{value:new ti.Texture}),_defineProperty(t,e.OVERLAY_UNIFORMS.overlay,{value:new ti.Texture}),_defineProperty(t,e.OVERLAY_UNIFORMS.globalOpacity,{value:1}),_defineProperty(t,e.OVERLAY_UNIFORMS.overlayOpacity,{value:1}),t),vertexShader:n||"\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"\nuniform sampler2D ".concat(e.OVERLAY_UNIFORMS.panorama,";\nuniform sampler2D ").concat(e.OVERLAY_UNIFORMS.overlay,";\nuniform float ").concat(e.OVERLAY_UNIFORMS.globalOpacity,";\nuniform float ").concat(e.OVERLAY_UNIFORMS.overlayOpacity,";\n\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 tColor1 = texture2D( ").concat(e.OVERLAY_UNIFORMS.panorama,", vUv );\n  vec4 tColor2 = texture2D( ").concat(e.OVERLAY_UNIFORMS.overlay,", vUv );\n  gl_FragColor = vec4(\n    mix( tColor1.rgb, tColor2.rgb, tColor2.a * ").concat(e.OVERLAY_UNIFORMS.overlayOpacity," ),\n    ").concat(e.OVERLAY_UNIFORMS.globalOpacity,"\n  );\n}")})}}]),e}(),ni=ii;ni.supportsDownload=!1,ni.supportsOverlay=!1,ni.OVERLAY_UNIFORMS={panorama:"panorama",overlay:"overlay",globalOpacity:"globalOpacity",overlayOpacity:"overlayOpacity"};var ri=se(),oi="".concat(Oe,"_touchSupport"),ai={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,fullscreenEvent:null,__maxCanvasWidth:null,get maxCanvasWidth(){return null===this.__maxCanvasWidth&&(this.__maxCanvasWidth=K(this.maxTextureWidth)),this.__maxCanvasWidth},load:function(){if(!this.loaded){var e=Z();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=null!==e,this.maxTextureWidth=e?e.getParameter(e.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=q(),this.fullscreenEvent=G(),this.loaded=!0}if(!ai.isWebGLSupported)throw new He("WebGL is not supported.");if(0===ai.maxTextureWidth)throw new He("Unable to detect system capabilities")}},si=B({resolution:64,blur:!1},{resolution:function(e){if(!e||!ri.MathUtils.isPowerOfTwo(e))throw new He("EquirectangularAdapter resolution must be power of two");return e}}),li=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,e),r.config=si(n),r.SPHERE_SEGMENTS=r.config.resolution,r.SPHERE_HORIZONTAL_SEGMENTS=r.SPHERE_SEGMENTS/2,r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"supportsTransition",value:function(){return!0}},{key:"supportsPreload",value:function(){return!0}},{key:"loadTexture",value:async function(e,t){var i,n,r,o,a,s,l,c,u,h,d,v,p,f,y,m,g,_,w,b,k=this,E=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.viewer.config.useXmpData;if("string"!=typeof e)return Promise.reject(new He("Invalid panorama url, are you using the right adapter?"));E?(b=await this.loadXMP(e,function(e){return k.viewer.loader.setProgress(e)}),w=await this.viewer.textureLoader.loadImage(e)):w=await this.viewer.textureLoader.loadImage(e,function(e){return k.viewer.loader.setProgress(e)}),"function"==typeof t&&(t=t(w));var C={fullWidth:O(null===(i=t)||void 0===i?void 0:i.fullWidth,null===(n=b)||void 0===n?void 0:n.fullWidth,w.width),fullHeight:O(null===(r=t)||void 0===r?void 0:r.fullHeight,null===(o=b)||void 0===o?void 0:o.fullHeight,w.height),croppedWidth:O(null===(a=t)||void 0===a?void 0:a.croppedWidth,null===(s=b)||void 0===s?void 0:s.croppedWidth,w.width),croppedHeight:O(null===(l=t)||void 0===l?void 0:l.croppedHeight,null===(c=b)||void 0===c?void 0:c.croppedHeight,w.height),croppedX:O(null===(u=t)||void 0===u?void 0:u.croppedX,null===(h=b)||void 0===h?void 0:h.croppedX,0),croppedY:O(null===(d=t)||void 0===d?void 0:d.croppedY,null===(v=b)||void 0===v?void 0:v.croppedY,0),poseHeading:O(null===(p=t)||void 0===p?void 0:p.poseHeading,null===(f=b)||void 0===f?void 0:f.poseHeading,0),posePitch:O(null===(y=t)||void 0===y?void 0:y.posePitch,null===(m=b)||void 0===m?void 0:m.posePitch,0),poseRoll:O(null===(g=t)||void 0===g?void 0:g.poseRoll,null===(_=b)||void 0===_?void 0:_.poseRoll,0)};C.croppedWidth===w.width&&C.croppedHeight===w.height||R("Invalid panoData, croppedWidth and/or croppedHeight is not coherent with loaded image.\n              panoData: ".concat(C.croppedWidth,"x").concat(C.croppedHeight,", image: ").concat(w.width,"x").concat(w.height)),(t||b)&&C.fullWidth!==2*C.fullHeight&&R("Invalid panoData, fullWidth should be twice fullHeight");var T=this.createEquirectangularTexture(w,C);return{panorama:e,texture:T,panoData:C}}},{key:"loadXMP",value:async function(e,t){var i=await this.viewer.textureLoader.loadFile(e,t),n=await this.loadBlobAsString(i),r=n.indexOf("<x:xmpmeta"),o=n.indexOf("</x:xmpmeta>"),a=n.substring(r,o);return-1!==r&&-1!==o&&a.includes("GPano:")?{fullWidth:N(a,"FullPanoWidthPixels"),fullHeight:N(a,"FullPanoHeightPixels"),croppedWidth:N(a,"CroppedAreaImageWidthPixels"),croppedHeight:N(a,"CroppedAreaImageHeightPixels"),croppedX:N(a,"CroppedAreaLeftPixels"),croppedY:N(a,"CroppedAreaTopPixels"),poseHeading:N(a,"PoseHeadingDegrees"),posePitch:N(a,"PosePitchDegrees"),poseRoll:N(a,"PoseRollDegrees")}:null}},{key:"loadBlobAsString",value:function(e){return new Promise(function(t,i){var n=new FileReader;n.onload=function(){return t(n.result)},n.onerror=i,n.readAsText(e)})}},{key:"createEquirectangularTexture",value:function(e,t){if(this.config.blur||t.fullWidth>ai.maxTextureWidth||t.croppedWidth!==t.fullWidth||t.croppedHeight!==t.fullHeight){var i=Math.min(1,ai.maxCanvasWidth/t.fullWidth),n={fullWidth:t.fullWidth*i,fullHeight:t.fullHeight*i,croppedWidth:t.croppedWidth*i,croppedHeight:t.croppedHeight*i,croppedX:t.croppedX*i,croppedY:t.croppedY*i},r=document.createElement("canvas");r.width=n.fullWidth,r.height=n.fullHeight;var o=r.getContext("2d");return this.config.blur&&(o.filter="blur(1px)"),o.drawImage(e,n.croppedX,n.croppedY,n.croppedWidth,n.croppedHeight),W(r)}return W(e)}},{key:"createMesh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=new ri.SphereGeometry(Pe*e,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1),i=ni.createOverlayMaterial();return new ri.Mesh(t,i)}},{key:"setTexture",value:function(e,t){this.__setUniform(e,ni.OVERLAY_UNIFORMS.panorama,t.texture),this.setOverlay(e,null,1)}},{key:"setOverlay",value:function(e,t,i){this.__setUniform(e,ni.OVERLAY_UNIFORMS.overlayOpacity,i),t?this.__setUniform(e,ni.OVERLAY_UNIFORMS.overlay,t.texture):this.__setUniform(e,ni.OVERLAY_UNIFORMS.overlay,new ri.Texture)}},{key:"setTextureOpacity",value:function(e,t){this.__setUniform(e,ni.OVERLAY_UNIFORMS.globalOpacity,t),e.material.transparent=t<1}},{key:"disposeTexture",value:function(e){var t;null===(t=e.texture)||void 0===t||t.dispose()}},{key:"__setUniform",value:function(e,t,i){_instanceof(e.material.uniforms[t].value,ri.Texture)&&e.material.uniforms[t].value.dispose(),e.material.uniforms[t].value=i}}]),t}(ni);li.id="equirectangular",li.supportsDownload=!0,li.supportsOverlay=!0;var ci=function(){function e(t,i){_classCallCheck(this,e),this.parent=t,this.children=[],this.container=document.createElement("div"),this.state={visible:!0},this.viewer=_instanceof(t,e)?t.viewer:t,this.container.className=i.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}return _createClass(e,[{key:"destroy",value:function(){this.parent.container.removeChild(this.container);var e=this.parent.children.indexOf(this);-1!==e&&this.parent.children.splice(e,1),this.children.slice().forEach(function(e){return e.destroy()}),this.children.length=0}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.isVisible();e?this.show():this.hide()}},{key:"hide",value:function(e){this.container.style.display="none",this.state.visible=!1}},{key:"show",value:function(e){this.container.style.display="",this.state.visible=!0}},{key:"isVisible",value:function(){return this.state.visible}}]),e}(),ui=B({id:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),hi=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,e,{className:"psv-button ".concat(n.hoverScale?"psv-button--hover-scale":""," ").concat(n.className||"")}),r.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},r.config=ui(n),r.config.id=r.constructor.id,n.icon&&r.__setIcon(n.icon),r.state.width=r.container.offsetWidth,r.config.title?r.container.title=r.config.title:r.id&&r.id in r.viewer.config.lang&&(r.container.title=r.viewer.config.lang[r.id]),n.tabbable&&(r.container.tabIndex=0),r.container.addEventListener("click",function(e){r.state.enabled&&r.onClick(),e.stopPropagation()}),r.container.addEventListener("keydown",function(e){e.key===xe.Enter&&r.state.enabled&&(r.onClick(),e.stopPropagation())}),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"id",get:function(){return this.config.id}},{key:"title",get:function(){return this.container.title}},{key:"content",get:function(){return this.container.innerHTML}},{key:"width",get:function(){return this.state.width}},{key:"collapsable",get:function(){return this.config.collapsable}},{key:"show",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),e&&this.viewer.navbar.autoSize())}},{key:"hide",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",e&&this.viewer.navbar.autoSize())}},{key:"checkSupported",value:function(){var e=this;x(this.isSupported(),function(t,i){e.state&&(e.state.supported=t,i?t||e.hide():e.toggle(t))})}},{key:"autoSize",value:function(){}},{key:"isSupported",value:function(){return!0}},{key:"toggleActive",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.state.active;e!==this.state.active&&(this.state.active=e,u(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}},{key:"disable",value:function(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}},{key:"enable",value:function(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}},{key:"collapse",value:function(){this.state.collapsed=!0,this.container.style.display="none"}},{key:"uncollapse",value:function(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}},{key:"__setIcon",value:function(e){this.container.innerHTML=e,h(this.container.querySelector("svg"),"psv-button-svg")}}]),t}(ci),di=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,e,{className:"psv-custom-button ".concat(n.className||""),hoverScale:!1,collapsable:!1!==n.collapsable,tabbable:!1!==n.tabbable,title:n.title}),r.customOnClick=n.onClick,n.id?r.config.id=n.id:r.config.id="psvButton-"+Math.random().toString(36).substring(2),n.content&&(r.container.innerHTML=n.content),r.state.width=r.container.offsetWidth,n.disabled&&r.disable(),!1===n.visible&&r.hide(),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"onClick",value:function(){var e;null===(e=this.customOnClick)||void 0===e||e.call(this,this.viewer)}}]),t}(hi),vi=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ie.info}),n.mode=0,n.viewer.addEventListener(ft.type,_assertThisInitialized(n)),n.viewer.addEventListener(Rt.type,_assertThisInitialized(n)),n.viewer.addEventListener(_t.type,_assertThisInitialized(n)),n.viewer.addEventListener(Dt.type,_assertThisInitialized(n)),n.viewer.addEventListener(ct.type,_assertThisInitialized(n)),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.viewer.removeEventListener(ft.type,this),this.viewer.removeEventListener(Rt.type,this),this.viewer.removeEventListener(_t.type,this),this.viewer.removeEventListener(Dt.type,this),this.viewer.removeEventListener(ct.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){if(_instanceof(e,ct))e.containsOptions("description")&&this.autoSize(!0);else if(this.mode){var t=!1;_instanceof(e,ft)?t=1===this.mode:_instanceof(e,Rt)?t=1===this.mode&&e.notificationId!==Le.DESCRIPTION:_instanceof(e,_t)?t=2===this.mode:_instanceof(e,Dt)&&(t=2===this.mode&&e.panelId!==Le.DESCRIPTION),t&&(this.toggleActive(!1),this.mode=0)}}},{key:"onClick",value:function(){this.mode?this.__close():this.__open()}},{key:"hide",value:function(e){_get(_getPrototypeOf(t.prototype),"hide",this).call(this,e),this.mode&&this.__close()}},{key:"autoSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){var t=this.viewer.navbar.getButton("caption",!1),i=t&&!t.isVisible(),n=!!this.viewer.config.description;i||n?this.show(!1):this.hide(!1)}}},{key:"__close",value:function(){switch(this.mode){case 1:this.viewer.notification.hide(Le.DESCRIPTION);break;case 2:this.viewer.panel.hide(Le.DESCRIPTION)}}},{key:"__open",value:function(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:Le.DESCRIPTION,content:(this.viewer.config.caption?"<p>".concat(this.viewer.config.caption,"</p>"):"")+this.viewer.config.description})):(this.mode=1,this.viewer.notification.show({id:Le.DESCRIPTION,content:this.viewer.config.caption}))}}]),t}(hi);vi.id="description";var pi=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-download-butto",hoverScale:!0,collapsable:!0,tabbable:!0,icon:Ie.download}),n.viewer.addEventListener(ct.type,_assertThisInitialized(n)),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.viewer.removeEventListener(ct.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){_instanceof(e,ct)&&e.containsOptions("downloadUrl")&&this.checkSupported()}},{key:"onClick",value:function(){var e=this,t=document.createElement("a");t.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,t.href.startsWith("data:")&&!this.viewer.config.downloadName?t.download="panorama."+t.href.substring(0,t.href.indexOf(";")).split("/").pop():t.download=this.viewer.config.downloadName||t.href.split("/").pop(),this.viewer.container.appendChild(t),t.click(),setTimeout(function(){e.viewer.container.removeChild(t)},100)}},{key:"checkSupported",value:function(){var e=this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl;e?this.show():this.hide()}}]),t}(hi);pi.id="download";var fi=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ie.fullscreenIn,iconActive:Ie.fullscreenOut}),n.viewer.addEventListener(vt.type,_assertThisInitialized(n)),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.viewer.removeEventListener(vt.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){_instanceof(e,vt)&&this.toggleActive(e.fullscreenEnabled)}},{key:"onClick",value:function(){this.viewer.toggleFullscreen()}}]),t}(hi);fi.id="fullscreen";var yi="psvButton",mi=function(e,t){return'\n<div class="psv-panel-menu psv-panel-menu--stripped">\n  <h1 class="psv-panel-menu-title">'.concat(Ie.menu," ").concat(t,'</h1>\n  <ul class="psv-panel-menu-list">\n    ').concat(e.map(function(e){return'\n    <li data-psv-button="'.concat(e.id,'" class="psv-panel-menu-item" tabindex="0">\n      <span class="psv-panel-menu-item-icon">').concat(e.content,'</span>\n      <span class="psv-panel-menu-item-label">').concat(e.title,"</span>\n    </li>\n    ")}).join(""),"\n  </ul>\n</div>\n")},gi=function(e){function t(e){var n,r;return _classCallCheck(this,t),r=i.call(this,e,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Ie.menu}),r.viewer.addEventListener(Dt.type,_assertThisInitialized(r)),r.viewer.addEventListener(_t.type,_assertThisInitialized(r)),_get((n=_assertThisInitialized(r),_getPrototypeOf(t.prototype)),"hide",n).call(n),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.viewer.removeEventListener(Dt.type,this),this.viewer.removeEventListener(_t.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){_instanceof(e,Dt)?this.toggleActive(e.panelId===Le.MENU):_instanceof(e,_t)&&this.toggleActive(!1)}},{key:"onClick",value:function(){this.state.active?this.__hideMenu():this.__showMenu()}},{key:"hide",value:function(e){_get(_getPrototypeOf(t.prototype),"hide",this).call(this,e),this.__hideMenu()}},{key:"show",value:function(e){_get(_getPrototypeOf(t.prototype),"show",this).call(this,e),this.state.active&&this.__showMenu()}},{key:"__showMenu",value:function(){var e=this;this.viewer.panel.show({id:Le.MENU,content:mi(this.viewer.navbar.collapsed,this.viewer.config.lang.menu),noMargin:!0,clickHandler:function(t){var i=t?p(t,"li"):void 0,n=i?i.dataset[yi]:void 0;n&&(e.viewer.navbar.getButton(n).onClick(),e.__hideMenu())}})}},{key:"__hideMenu",value:function(){this.viewer.panel.hide(Le.MENU)}}]),t}(hi);gi.id="menu";var _i=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,e,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Q(n)}),r.direction=n,r.handler=new Ze,r.container.addEventListener("mousedown",_assertThisInitialized(r)),r.container.addEventListener("keydown",_assertThisInitialized(r)),r.container.addEventListener("keyup",_assertThisInitialized(r)),r.viewer.container.addEventListener("mouseup",_assertThisInitialized(r)),r.viewer.container.addEventListener("touchend",_assertThisInitialized(r)),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":e.key===xe.Enter&&this.__onMouseDown();break;case"keyup":e.key===xe.Enter&&this.__onMouseUp()}}},{key:"onClick",value:function(){}},{key:"isSupported",value:function(){return I(ai.isTouchEnabled)}},{key:"__onMouseDown",value:function(){if(this.state.enabled){var e={};switch(this.direction){case 0:e.pitch=!1;break;case 1:e.pitch=!0;break;case 3:e.yaw=!1;break;default:e.yaw=!0}this.viewer.stopAll(),this.viewer.dynamics.position.roll(e),this.handler.down()}}},{key:"__onMouseUp",value:function(){var e=this;this.state.enabled&&this.handler.up(function(){e.viewer.dynamics.position.stop(),e.viewer.resetIdleTimer()})}}]),t}(hi);_i.groupId="move";var wi=function(e){function t(e){return _classCallCheck(this,t),i.call(this,e,1)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(_i);wi.id="moveDown";var bi=function(e){function t(e){return _classCallCheck(this,t),i.call(this,e,2)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(_i);bi.id="moveLeft";var ki=function(e){function t(e){return _classCallCheck(this,t),i.call(this,e,3)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(_i);ki.id="moveRight";var Ei=function(e){function t(e){return _classCallCheck(this,t),i.call(this,e,0)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(_i);Ei.id="moveUp";var Ci=function(e){function t(e,n,r){var o;return _classCallCheck(this,t),o=i.call(this,e,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:r}),o.direction=n,o.handler=new Ze,o.container.addEventListener("mousedown",_assertThisInitialized(o)),o.container.addEventListener("keydown",_assertThisInitialized(o)),o.container.addEventListener("keyup",_assertThisInitialized(o)),o.viewer.container.addEventListener("mouseup",_assertThisInitialized(o)),o.viewer.container.addEventListener("touchend",_assertThisInitialized(o)),o}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":e.key===xe.Enter&&this.__onMouseDown();break;case"keyup":e.key===xe.Enter&&this.__onMouseUp()}}},{key:"onClick",value:function(){}},{key:"isSupported",value:function(){return I(ai.isTouchEnabled)}},{key:"__onMouseDown",value:function(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(1===this.direction),this.handler.down())}},{key:"__onMouseUp",value:function(){var e=this;this.state.enabled&&this.handler.up(function(){return e.viewer.dynamics.zoom.stop()})}}]),t}(hi);Ci.groupId="zoom";var Ti=function(e){function t(e){return _classCallCheck(this,t),i.call(this,e,0,Ie.zoomIn)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Ci);Ti.id="zoomIn";var Si=function(e){function t(e){return _classCallCheck(this,t),i.call(this,e,1,Ie.zoomOut)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(Ci);Si.id="zoomOut";var Pi=function(e){function t(e){var n
;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),n.zoomRange=document.createElement("div"),n.zoomRange.className="psv-zoom-range-line",n.container.appendChild(n.zoomRange),n.zoomValue=document.createElement("div"),n.zoomValue.className="psv-zoom-range-handle",n.zoomRange.appendChild(n.zoomValue),n.slider=new Ke(n.container,"HORIZONTAL",function(e){return n.__onSliderUpdate(e)}),n.mediaMinWidth=parseInt(y(n.container,"maxWidth"),10),n.viewer.addEventListener(Zt.type,_assertThisInitialized(n)),n.viewer.state.ready?n.__moveZoomValue(n.viewer.getZoomLevel()):n.viewer.addEventListener(xt.type,_assertThisInitialized(n)),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.slider.destroy(),this.viewer.removeEventListener(Zt.type,this),this.viewer.removeEventListener(xt.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){_instanceof(e,Zt)?this.__moveZoomValue(e.zoomLevel):_instanceof(e,xt)&&this.__moveZoomValue(this.viewer.getZoomLevel())}},{key:"onClick",value:function(){}},{key:"isSupported",value:function(){return I(ai.isTouchEnabled)}},{key:"autoSize",value:function(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}},{key:"__moveZoomValue",value:function(e){this.zoomValue.style.left=e/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}},{key:"__onSliderUpdate",value:function(e){e.mousedown&&this.viewer.zoom(100*e.value)}}]),t}(hi);Pi.id="zoomRange",Pi.groupId="zoom";var Oi=se(),Mi=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this),n.viewer=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"init",value:function(){}},{key:"destroy",value:function(){}}]),t}($e),Li=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,e),r.config=r.constructor.configParser(n),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"setOption",value:function(e,t){this.setOptions(_defineProperty({},e,t))}},{key:"setOptions",value:function(e){for(var t={...this.config,...e},i=this.constructor,n=i.configParser,r=i.readonlyOptions,o=i.id,a=0,s=Object.entries(e);a<s.length;a++){var l=_slicedToArray(s[a],2),c=l[0],u=l[1];c in n.defaults?r.includes(c)?R("".concat(o,': Option "').concat(c,'" cannot be updated')):(c in n.parsers&&(u=n.parsers[c](u,{rawConfig:t,defValue:n.defaults[c]})),this.config[c]=u):R("".concat(o,': Unknown option "').concat(c,'"'))}}}]),t}(Mi);Li.readonlyOptions=[];var xi={panorama:null,overlay:null,overlayOpacity:1,container:null,adapter:[li,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"Loading...",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:!0,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,useXmpData:!0,panoData:null,requestHeaders:null,canvasBackground:"#000",withCredentials:!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",download:"Download",fullscreen:"Fullscreen",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama can't be loaded"},keyboard:"fullscreen",keyboardActions:(ee={},_defineProperty(ee,xe.ArrowUp,"ROTATE_UP"),_defineProperty(ee,xe.ArrowDown,"ROTATE_DOWN"),_defineProperty(ee,xe.ArrowRight,"ROTATE_RIGHT"),_defineProperty(ee,xe.ArrowLeft,"ROTATE_LEFT"),_defineProperty(ee,xe.PageUp,"ZOOM_IN"),_defineProperty(ee,xe.PageDown,"ZOOM_OUT"),_defineProperty(ee,xe.Plus,"ZOOM_IN"),_defineProperty(ee,xe.Minus,"ZOOM_OUT"),ee)},Ii={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",overlay:"Use setOverlay method to changer the overlay",overlayOpacity:"Use setOverlay method to changer the overlay",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},zi={container:function(e){if(!e)throw new He("No value given for container.");return e},adapter:function(e,t){var i=t.defValue;if(e=e?Array.isArray(e)?[X(e[0]),e[1]]:[X(e),null]:i,!e[0])throw new He("An undefined value was given for adapter.");if(!e[0].id)throw new He("Adapter has no id.");return e},overlayOpacity:function(e){return Oi.MathUtils.clamp(e,0,1)},defaultYaw:function(e){return F(e)},defaultPitch:function(e){return F(e,!0)},defaultZoomLvl:function(e){return Oi.MathUtils.clamp(e,0,100)},minFov:function(e,t){var i=t.rawConfig;return i.maxFov<e&&(R("maxFov cannot be lower than minFov"),e=i.maxFov),Oi.MathUtils.clamp(e,1,179)},maxFov:function(e,t){var i=t.rawConfig;return e<i.minFov&&(e=i.minFov),Oi.MathUtils.clamp(e,1,179)},lang:function(e){return Array.isArray(e.twoFingers)&&(R("lang.twoFingers must not be an array"),e.twoFingers=e.twoFingers[0]),{...xi.lang,...e}},keyboard:function(e){return!!e&&("object"===_typeof(e)?(R("Use keyboardActions to configure the keyboard actions, keyboard option must be either true, false, 'fullscreen' or 'always'"),"fullscreen"):"always"===e?"always":"fullscreen")},keyboardActions:function(e,t){var i=t.rawConfig;return i.keyboard&&"object"===_typeof(i.keyboard)?i.keyboard:e},fisheye:function(e){return!0===e?1:!1===e?0:e},requestHeaders:function(e){return e&&"object"===_typeof(e)?function(){return e}:"function"==typeof e?e:null},plugins:function(e){return e.map(function(e,t){if(e=Array.isArray(e)?[$(e[0]),e[1]]:[$(e),null],!e[0])throw new He("An undefined value was given for plugin ".concat(t,"."));if(!e[0].id)throw new He("Plugin ".concat(t," has no id."));return e})},navbar:function(e){return!1===e?null:!0===e?T(xi.navbar):"string"==typeof e?e.split(/[ ,]/):e}},Ai=B(xi,zi),Ri=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),n.contentWidth=0,n.state.width=0,n.contentElt=document.createElement("div"),n.contentElt.className="psv-caption-content",n.container.appendChild(n.contentElt),n.setCaption(n.viewer.config.caption),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"hide",value:function(){this.contentElt.style.display="none",this.state.visible=!1}},{key:"show",value:function(){this.contentElt.style.display="",this.state.visible=!0}},{key:"onClick",value:function(){}},{key:"setCaption",value:function(e){this.show(),this.contentElt.innerHTML=null!=e?e:"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}},{key:"autoSize",value:function(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}},{key:"__refreshButton",value:function(){var e;null===(e=this.viewer.navbar.getButton(vi.id,!1))||void 0===e||e.autoSize(!0)}}]),t}(hi);Ri.id="caption";var Hi={},Ni={};[Si,Pi,Ti,vi,Ri,pi,fi,bi,ki,Ei,wi].forEach(function(e){return J(e)});var Vi=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-navbar psv--capture-event"}),n.collapsed=[],n.state.visible=!1,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"show",value:function(){this.container.classList.add("psv-navbar--open"),this.state.visible=!0}},{key:"hide",value:function(){this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}},{key:"setButtons",value:function(e){var t=this;this.children.slice().forEach(function(e){return e.destroy()}),this.children.length=0,-1!==e.indexOf(Ri.id)&&-1===e.indexOf(vi.id)&&e.splice(e.indexOf(Ri.id),0,vi.id),e.forEach(function(e){"object"===_typeof(e)?new di(t,e):Hi[e]?new Hi[e](t):Ni[e]?Ni[e].forEach(function(e){new e(t)}):R("Unknown button ".concat(e))}),new gi(this),this.children.forEach(function(e){_instanceof(e,hi)&&e.checkSupported()}),this.autoSize()}},{key:"setCaption",value:function(e){this.children.some(function(t){return!!_instanceof(t,Ri)&&(t.setCaption(e),!0)})}},{key:"getButton",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.children.find(function(t){return _instanceof(t,hi)&&t.id===e});return!i&&t&&R('button "'.concat(e,'" not found in the navbar')),i}},{key:"autoSize",value:function(){var e;this.children.forEach(function(e){_instanceof(e,hi)&&e.autoSize()});var t=this.container.offsetWidth,i=0,n=[];this.children.forEach(function(e){e.isVisible()&&_instanceof(e,hi)&&(i+=e.width,e.collapsable&&n.push(e))}),0!==i&&(t<i&&n.length>0?(n.forEach(function(e){return e.collapse()}),this.collapsed=n,this.getButton(gi.id).show(!1)):t>=i&&this.collapsed.length>0&&(this.collapsed.forEach(function(e){return e.uncollapse()}),this.collapsed=[],this.getButton(gi.id).hide(!1)),null===(e=this.getButton(Ri.id,!1))||void 0===e||e.autoSize())}}]),t}(ci),Di=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-loader-container"}),n.loader=document.createElement("div"),n.loader.className="psv-loader",n.container.appendChild(n.loader),n.size=n.loader.offsetWidth,n.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),n.canvas.setAttribute("class","psv-loader-canvas"),n.canvas.setAttribute("viewBox","0 0 ".concat(n.size," ").concat(n.size)),n.loader.appendChild(n.canvas),n.textColor=y(n.loader,"color"),n.color=y(n.canvas,"color"),n.border=parseInt(y(n.loader,"outlineWidth"),10),n.thickness=parseInt(y(n.canvas,"outlineWidth"),10),n.viewer.addEventListener(ct.type,_assertThisInitialized(n)),n.__updateContent(),n.hide(),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.viewer.removeEventListener(ct.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){_instanceof(e,ct)&&e.containsOptions("loadingImg","loadingTxt")&&this.__updateContent()}},{key:"setProgress",value:function(e){var t=Math.min(e,99.999)/100*Math.PI*2,i=this.size/2,n=i,r=this.thickness/2+this.border,o=(this.size-this.thickness)/2-this.border,a=Math.sin(t)*o+i,s=-Math.cos(t)*o+i,l=e>50?"1":"0";this.canvas.innerHTML='\n            <circle cx="'.concat(i,'" cy="').concat(i,'" r="').concat(i,'" fill="').concat(this.color,'"/>\n            <path d="M ').concat(n," ").concat(r," A ").concat(o," ").concat(o," 0 ").concat(l," 1 ").concat(a," ").concat(s,'" \n                  fill="none" stroke="').concat(this.textColor,'" stroke-width="').concat(this.thickness,'" stroke-linecap="round"/>\n        '),this.viewer.dispatchEvent(new Tt(Math.round(e)))}},{key:"__updateContent",value:function(){var e,t=this.loader.querySelector(".psv-loader-image, .psv-loader-text");if(t&&this.loader.removeChild(t),this.viewer.config.loadingImg?(e=document.createElement("img"),e.className="psv-loader-image",e.src=this.viewer.config.loadingImg):this.viewer.config.loadingTxt&&(e=document.createElement("div"),e.className="psv-loader-text",e.innerHTML=this.viewer.config.loadingTxt),e){var i=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));e.style.maxWidth=i+"px",e.style.maxHeight=i+"px",this.loader.appendChild(e)}}}]),t}(ci),ji=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-notification"}),n.state={visible:!1,contentId:null,timeout:null},n.content=document.createElement("div"),n.content.className="psv-notification-content",n.container.appendChild(n.content),n.content.addEventListener("click",function(){return n.hide()}),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"isVisible",value:function(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}},{key:"toggle",value:function(){throw new He("Notification cannot be toggled")}},{key:"show",value:function(e){var t=this;this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),"string"==typeof e&&(e={content:e}),this.state.contentId=e.id||null,this.content.innerHTML=e.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new Rt(e.id)),e.timeout&&(this.state.timeout=setTimeout(function(){return t.hide(t.state.contentId)},e.timeout))}},{key:"hide",value:function(e){if(this.isVisible(e)){var t=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new ft(t))}}}]),t}(ci),Ui=function(e){function t(e){var n,r;return _classCallCheck(this,t),r=i.call(this,e,{className:"psv-overlay"}),r.state={visible:!1,contentId:null,dissmisable:!0},r.image=document.createElement("div"),r.image.className="psv-overlay-image",r.container.appendChild(r.image),r.title=document.createElement("div"),r.title.className="psv-overlay-title",r.container.appendChild(r.title),r.text=document.createElement("div"),r.text.className="psv-overlay-text",r.container.appendChild(r.text),r.viewer.addEventListener(st.type,_assertThisInitialized(r)),r.viewer.addEventListener(Et.type,_assertThisInitialized(r)),_get((n=_assertThisInitialized(r),_getPrototypeOf(t.prototype)),"hide",n).call(n),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.viewer.removeEventListener(st.type,this),this.viewer.removeEventListener(Et.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){_instanceof(e,st)?this.isVisible()&&this.state.dissmisable&&(this.hide(),e.stopPropagation()):_instanceof(e,Et)&&this.isVisible()&&this.state.dissmisable&&e.key===xe.Escape&&(this.hide(),e.preventDefault())}},{key:"isVisible",value:function(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}},{key:"toggle",value:function(){throw new He("Overlay cannot be toggled")}},{key:"show",value:function(e){"string"==typeof e&&(e={title:e}),this.state.contentId=e.id||null,this.state.dissmisable=!1!==e.dissmisable,this.image.innerHTML=e.image||"",this.title.innerHTML=e.title||"",this.text.innerHTML=e.text||"",_get(_getPrototypeOf(t.prototype),"show",this).call(this),this.viewer.dispatchEvent(new Nt(e.id))}},{key:"hide",value:function(e){if(this.isVisible(e)){var i=this.state.contentId;_get(_getPrototypeOf(t.prototype),"hide",this).call(this),this.state.contentId=null,this.viewer.dispatchEvent(new mt(i))}}}]),t}(ci),Fi=200,Wi="psv-panel-content--no-interaction",Yi=function(e){function t(e){var n;_classCallCheck(this,t),n=i.call(this,e,{className:"psv-panel psv--capture-event"}),n.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};var r=document.createElement("div");r.className="psv-panel-resizer",n.container.appendChild(r);var o=document.createElement("div");return o.className="psv-panel-close-button",o.innerHTML=Ie.close,o.title=e.config.lang.close,n.container.appendChild(o),n.content=document.createElement("div"),n.content.className="psv-panel-content",n.container.appendChild(n.content),n.container.addEventListener("wheel",function(e){return e.stopPropagation()}),o.addEventListener("click",function(){return n.hide()}),r.addEventListener("mousedown",_assertThisInitialized(n)),r.addEventListener("touchstart",_assertThisInitialized(n)),n.viewer.container.addEventListener("mouseup",_assertThisInitialized(n)),n.viewer.container.addEventListener("touchend",_assertThisInitialized(n)),n.viewer.container.addEventListener("mousemove",_assertThisInitialized(n)),n.viewer.container.addEventListener("touchmove",_assertThisInitialized(n)),n.viewer.addEventListener(Et.type,_assertThisInitialized(n)),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.viewer.removeEventListener(Et.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"mousemove":this.__onMouseMove(e);break;case"touchmove":this.__onTouchMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchend":this.__onTouchEnd(e);break;case Et.type:this.__onKeyPress(e)}}},{key:"isVisible",value:function(e){return this.state.visible&&(!e||!this.state.contentId||this.state.contentId===e)}},{key:"toggle",value:function(){throw new He("Panel cannot be toggled")}},{key:"show",value:function(e){var t=this;"string"==typeof e&&(e={content:e});var i=this.isVisible(e.id);this.state.contentId=e.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),e.id&&this.state.width[e.id]?this.container.style.width=this.state.width[e.id]:e.width?this.container.style.width=e.width:this.container.style.width=null,this.content.innerHTML=e.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),u(this.content,"psv-panel-content--no-margin",!0===e.noMargin),e.clickHandler&&(this.state.clickHandler=function(t){e.clickHandler(t.target)},this.state.keyHandler=function(t){t.key===xe.Enter&&e.clickHandler(t.target)},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),i||setTimeout(function(){var e;null===(e=t.content.querySelector("a,button,[tabindex]"))||void 0===e||e.focus()},300)),this.viewer.dispatchEvent(new Dt(e.id))}},{key:"hide",value:function(e){if(this.isVisible(e)){var t=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.state.clickHandler=null),this.viewer.dispatchEvent(new _t(t))}}},{key:"__onMouseDown",value:function(e){e.stopPropagation(),this.__startResize(e.clientX,e.clientY)}},{key:"__onTouchStart",value:function(e){if(e.stopPropagation(),1===e.touches.length){var t=e.touches[0];this.__startResize(t.clientX,t.clientY)}}},{key:"__onMouseUp",value:function(e){this.state.mousedown&&(e.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(Wi))}},{key:"__onTouchEnd",value:function(e){this.state.mousedown&&(e.stopPropagation(),0===e.touches.length&&(this.state.mousedown=!1,this.content.classList.remove(Wi)))}},{key:"__onMouseMove",value:function(e){this.state.mousedown&&(e.stopPropagation(),this.__resize(e.clientX,e.clientY))}},{key:"__onTouchMove",value:function(e){if(this.state.mousedown){var t=e.touches[0];this.__resize(t.clientX,t.clientY)}}},{key:"__onKeyPress",value:function(e){this.isVisible()&&e.key===xe.Escape&&(this.hide(),e.preventDefault())}},{key:"__startResize",value:function(e,t){this.state.mouseX=e,this.state.mouseY=t,this.state.mousedown=!0,this.content.classList.add(Wi)}},{key:"__resize",value:function(e,t){var i=e,n=t,r=Math.max(Fi,this.container.offsetWidth-(i-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=r),this.container.style.width=r,this.state.mouseX=i,this.state.mouseY=n}}]),t}(ci),Bi=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,e,{className:"psv-tooltip"}),r.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null},r.content=document.createElement("div"),r.content.className="psv-tooltip-content",r.container.appendChild(r.content),r.arrow=document.createElement("div"),r.arrow.className="psv-tooltip-arrow",r.container.appendChild(r.arrow),r.container.addEventListener("transitionend",_assertThisInitialized(r)),r.container.style.top="-1000px",r.container.style.left="-1000px",r.show(n),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"handleEvent",value:function(e){"transitionend"===e.type&&this.__onTransitionEnd(e)}},{key:"destroy",value:function(){delete this.state.data,_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"toggle",value:function(){throw new He("Tooltip cannot be toggled")}},{key:"show",value:function(e){if(0!==this.state.state)throw new He("Initialized tooltip cannot be re-initialized");e.className&&h(this.container,e.className),this.state.state=3,this.update(e.content,e),this.state.data=e.data,this.state.state=1,this.viewer.dispatchEvent(new Ut(this,this.state.data)),this.__waitImages()}},{key:"update",value:function(e,t){this.content.innerHTML=e;var i=this.container.getBoundingClientRect();this.state.width=i.right-i.left,this.state.height=i.bottom-i.top,this.state.arrow=parseInt(y(this.arrow,"borderTopWidth"),10),this.state.border=parseInt(y(this.container,"borderTopLeftRadius"),10),this.move(null!=t?t:this.state.config)}},{key:"move",value:function(e){if(1!==this.state.state&&3!==this.state.state)throw new He("Uninitialized tooltip cannot be moved");e.box||(e.box={width:0,height:0}),this.state.config=e;var t=this.container,i=this.arrow,n={posClass:D(e.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(n,e);var r=null,o=null;if(n.top<0?r="bottom":n.top+n.height>this.viewer.state.size.height&&(r="top"),n.left<0?o="right":n.left+n.width>this.viewer.state.size.width&&(o="left"),o||r){var a=j(n.posClass);r&&(n.posClass[a?0:1]=r),o&&(n.posClass[a?1:0]=o),this.__computeTooltipPosition(n,e)}t.style.top=n.top+"px",t.style.left=n.left+"px",i.style.top=n.arrowTop+"px",i.style.left=n.arrowLeft+"px";var s=n.posClass.join("-");s!==this.state.pos&&(t.classList.remove("psv-tooltip--".concat(this.state.pos)),this.state.pos=s,t.classList.add("psv-tooltip--".concat(this.state.pos)))}},{key:"hide",value:function(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new bt(this.state.data))}},{key:"__onTransitionEnd",value:function(e){if("transform"===e.propertyName)switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy()}}},{key:"__computeTooltipPosition",value:function(e,t){var i=this.state.arrow,n=t.top,r=e.height,o=t.left,a=e.width,s=i+this.state.border,l=t.box.width/2+2*i,c=t.box.height/2+2*i;switch(e.posClass.join("-")){case"top-left":e.top=n-c-r,e.left=o+s-a,e.arrowTop=r,e.arrowLeft=a-s-i;break;case"top-center":e.top=n-c-r,e.left=o-a/2,e.arrowTop=r,e.arrowLeft=a/2-i;break;case"top-right":e.top=n-c-r,e.left=o-s,e.arrowTop=r,e.arrowLeft=i;break;case"bottom-left":e.top=n+c,e.left=o+s-a,e.arrowTop=2*-i,e.arrowLeft=a-s-i;break;case"bottom-center":e.top=n+c,e.left=o-a/2,e.arrowTop=2*-i,e.arrowLeft=a/2-i;break;case"bottom-right":e.top=n+c,e.left=o-s,e.arrowTop=2*-i,e.arrowLeft=i;break;case"left-top":e.top=n+s-r,e.left=o-l-a,e.arrowTop=r-s-i,e.arrowLeft=a;break;case"center-left":e.top=n-r/2,e.left=o-l-a,e.arrowTop=r/2-i,e.arrowLeft=a;break;case"left-bottom":e.top=n-s,e.left=o-l-a,e.arrowTop=i,e.arrowLeft=a;break;case"right-top":e.top=n+s-r,e.left=o+l,e.arrowTop=r-s-i,e.arrowLeft=2*-i;break;case"center-right":e.top=n-r/2,e.left=o+l,e.arrowTop=r/2-i,e.arrowLeft=2*-i;break;case"right-bottom":e.top=n-s,e.left=o+l,e.arrowTop=i,e.arrowLeft=2*-i}}},{key:"__waitImages",value:function(){var e=this,t=this.content.querySelectorAll("img");if(t.length>0){var i=[];t.forEach(function(e){i.push(new Promise(function(t){e.onload=t,e.onerror=t}))}),Promise.all(i).then(function(){if(1===e.state.state||3===e.state.state){var t=e.container.getBoundingClientRect();e.state.width=t.right-t.left,e.state.height=t.bottom-t.top,e.move(e.state.config)}})}}}]),t}(ci),Xi='<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/><!--Created by Shastry from the Noun Project--></svg>\n',Zi=se(),qi=function(){function e(t){_classCallCheck(this,e),this.viewer=t,this.config=t.config,this.state=t.state}return _createClass(e,[{key:"destroy",value:function(){}}]),e}(),Ki=new Zi.Vector3,Gi=new Zi.Euler(0,0,0,"ZXY"),Qi=function(e){function t(e){return _classCallCheck(this,t),i.call(this,e)}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"fovToZoomLevel",value:function(e){var t=Math.round((e-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return t-2*(t-50)}},{key:"zoomLevelToFov",value:function(e){return this.config.maxFov+e/100*(this.config.minFov-this.config.maxFov)}},{key:"vFovToHFov",value:function(e){return Zi.MathUtils.radToDeg(2*Math.atan(Math.tan(Zi.MathUtils.degToRad(e)/2)*this.state.aspect))}},{key:"speedToDuration",value:function(e,t){if("number"!=typeof e){var i=U(e);return t/Math.abs(i)*1e3}return Math.abs(e)}},{key:"textureCoordsToSphericalCoords",value:function(e){var t=this.state.panoData;if(!t)throw new He("Current adapter does not support texture coordinates.");var i=(e.textureX+t.croppedX)/t.fullWidth*Math.PI*2,n=(e.textureY+t.croppedY)/t.fullHeight*Math.PI,r={yaw:i>=Math.PI?i-Math.PI:i+Math.PI,pitch:Math.PI/2-n};return Gi.equals(this.viewer.renderer.panoramaPose)&&Gi.equals(this.viewer.renderer.sphereCorrection)?r:(this.sphericalCoordsToVector3(r,Ki),Ki.applyEuler(this.viewer.renderer.panoramaPose),Ki.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(Ki))}},{key:"sphericalCoordsToTextureCoords",value:function(e){var t=this.state.panoData;if(!t)throw new He("Current adapter does not support texture coordinates.");Gi.equals(this.viewer.renderer.panoramaPose)&&Gi.equals(this.viewer.renderer.sphereCorrection)||(this.sphericalCoordsToVector3(e,Ki),Y(Ki,this.viewer.renderer.sphereCorrection),Y(Ki,this.viewer.renderer.panoramaPose),e=this.vector3ToSphericalCoords(Ki));var i=e.yaw/Math.PI/2*t.fullWidth,n=e.pitch/Math.PI*t.fullHeight;return{textureX:Math.round(e.yaw<Math.PI?i+t.fullWidth/2:i-t.fullWidth/2)-t.croppedX,textureY:Math.round(t.fullHeight/2-n)-t.croppedY}}},{key:"sphericalCoordsToVector3",value:function(e,t){return t||(t=new Zi.Vector3),t.x=Pe*-Math.cos(e.pitch)*Math.sin(e.yaw),t.y=Pe*Math.sin(e.pitch),t.z=Pe*Math.cos(e.pitch)*Math.cos(e.yaw),t}},{key:"vector3ToSphericalCoords",value:function(e){var t=Math.acos(e.y/Math.sqrt(e.x*e.x+e.y*e.y+e.z*e.z)),i=Math.atan2(e.x,e.z);return{yaw:i<0?-i:2*Math.PI-i,pitch:Math.PI/2-t}}},{key:"viewerCoordsToVector3",value:function(e){var t=this.viewer.renderer.getIntersections(e).filter(function(e){return e.object.userData[Oe]});return t.length?t[0].point:null}},{key:"viewerCoordsToSphericalCoords",value:function(e){var t=this.viewerCoordsToVector3(e);return t?this.vector3ToSphericalCoords(t):null}},{key:"vector3ToViewerCoords",value:function(e){var t=e.clone();return t.project(this.viewer.renderer.camera),{x:Math.round((t.x+1)/2*this.state.size.width),y:Math.round((1-t.y)/2*this.state.size.height)}}},{key:"sphericalCoordsToViewerCoords",value:function(e){return this.sphericalCoordsToVector3(e,Ki),this.vector3ToViewerCoords(Ki)}},{key:"cleanPosition",value:function(e){return void 0!==e.textureX&&void 0!==e.textureY?this.textureCoordsToSphericalCoords(e):{yaw:F(e.yaw),pitch:F(e.pitch,!this.state.littlePlanet)}}},{key:"cleanSphereCorrection",value:function(e){return{pan:F((null==e?void 0:e.pan)||0),tilt:F((null==e?void 0:e.tilt)||0,!0),roll:F((null==e?void 0:e.roll)||0,!0,!1)}}},{key:"cleanPanoramaPose",value:function(e){return{pan:Zi.MathUtils.degToRad((null==e?void 0:e.poseHeading)||0),tilt:Zi.MathUtils.degToRad((null==e?void 0:e.posePitch)||0),roll:Zi.MathUtils.degToRad((null==e?void 0:e.poseRoll)||0)}}}]),t}(qi),$i=se(),Ji='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/><!--Created by AomAm from the Noun Project--></svg>\n',en='<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/><!-- Created by Icon Island from the Noun Project --></svg>\n',tn=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e),n.data={step:0,startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,mouseHistory:[],pinchDist:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},n.keyHandler=new Ze,n.resizeObserver=new ResizeObserver(k(function(){return n.viewer.autoSize()},50)),n.moveThreshold=be*ai.pixelRatio,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"init",value:function(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),
window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener(ai.fullscreenEvent,this),this.resizeObserver.observe(this.viewer.container)}},{key:"destroy",value:function(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener(ai.fullscreenEvent,this),this.resizeObserver.disconnect(),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){switch(e.type){case"keydown":this.__onKeyDown(e);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(e);break;case"mouseup":this.__onMouseUp(e);break;case"touchmove":this.__onTouchMove(e);break;case"touchend":this.__onTouchEnd(e);break;case ai.fullscreenEvent:this.__onFullscreenChange()}if(!p(e.target,".psv--capture-event"))switch(e.type){case"mousedown":this.__onMouseDown(e);break;case"touchstart":this.__onTouchStart(e);break;case"wheel":this.__onMouseWheel(e)}}},{key:"__isStep",value:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return-1!==t.indexOf(this.data.step)}},{key:"__onKeyDown",value:function(e){if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=e.key===xe.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(Le.CTRL_ZOOM))),this.viewer.dispatchEvent(new Et(e.key))&&this.state.keyboardEnabled&&this.config.keyboard){var t=this.config.keyboardActions[e.key];if("function"==typeof t)t(this.viewer),e.preventDefault();else if(t&&!this.keyHandler.pending){switch("ZOOM_IN"!==t&&"ZOOM_OUT"!==t&&this.viewer.stopAll(),t){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0)}this.keyHandler.down(),e.preventDefault()}}}},{key:"__onKeyUp",value:function(){var e=this;this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up(function(){e.viewer.dynamics.position.stop(),e.viewer.dynamics.zoom.stop(),e.viewer.resetIdleTimer()})}},{key:"__onMouseDown",value:function(e){this.data.step=1,this.data.startMouseX=e.clientX,this.data.startMouseY=e.clientY}},{key:"__onMouseUp",value:function(e){this.__isStep(1,2)&&this.__stopMove(e.clientX,e.clientY,e.target,2===e.button)}},{key:"__onMouseMove",value:function(e){this.config.mousemove&&this.__isStep(1,2)&&(e.preventDefault(),this.__doMove(e.clientX,e.clientY)),this.__handleObjectsEvents(e)}},{key:"__onTouchStart",value:function(e){var t=this;1===e.touches.length?(this.data.step=1,this.data.startMouseX=e.touches[0].clientX,this.data.startMouseY=e.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout(function(){var i=e.touches[0];t.__stopMove(i.clientX,i.clientY,i.target,!0),t.data.longtouchTimeout=null},Ee))):2===e.touches.length&&(this.data.step=0,this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(e),e.preventDefault()))}},{key:"__onTouchEnd",value:function(e){if(this.__cancelLongTouch(),this.__isStep(1,2))if(e.preventDefault(),this.__cancelTwoFingersOverlay(),1===e.touches.length)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(0===e.touches.length){var t=e.changedTouches[0];this.__stopMove(t.clientX,t.clientY,t.target)}}},{key:"__onTouchMove",value:function(e){var t=this;if(this.__cancelLongTouch(),this.config.mousemove)if(1===e.touches.length){if(this.config.touchmoveTwoFingers)this.__isStep(1)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout(function(){t.viewer.overlay.show({id:Le.TWO_FINGERS,image:Ji,title:t.config.lang.twoFingers})},Ce));else if(this.__isStep(1,2)){e.preventDefault();var i=e.touches[0];this.__doMove(i.clientX,i.clientY)}}else this.__doMoveZoom(e),this.__cancelTwoFingersOverlay()}},{key:"__cancelLongTouch",value:function(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}},{key:"__cancelTwoFingersOverlay",value:function(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(Le.TWO_FINGERS))}},{key:"__onMouseWheel",value:function(e){var t=this;if(this.config.mousewheel){if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown)return this.viewer.overlay.show({id:Le.CTRL_ZOOM,image:en,title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),void(this.data.ctrlZoomTimeout=setTimeout(function(){return t.viewer.overlay.hide(Le.CTRL_ZOOM)},Te));e.preventDefault(),e.stopPropagation();var i=e.deltaY/Math.abs(e.deltaY)*5*this.config.zoomSpeed;0!==i&&this.viewer.dynamics.zoom.step(-i,5)}}},{key:"__onFullscreenChange",value:function(){var e=this.viewer.isFullscreenEnabled();"fullscreen"===this.config.keyboard&&(e?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new vt(e))}},{key:"__resetMove",value:function(){this.data.step=0,this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0,this.data.mouseHistory.length=0}},{key:"__startMoveZoom",value:function(e){this.viewer.stopAll(),this.__resetMove();var t=m(e);this.data.step=2,this.data.pinchDist=t.distance;var i=t.center;this.data.mouseX=i.x,this.data.mouseY=i.y,this.__logMouseMove(this.data.mouseX,this.data.mouseY)}},{key:"__stopMove",value:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];this.__isStep(2)?this.config.moveInertia?(this.__logMouseMove(e,t),this.__stopMoveInertia(e,t)):(this.__resetMove(),this.viewer.resetIdleTimer()):this.__isStep(1)&&(this.viewer.stopAnimation(),this.__doClick(e,t,i,n),this.__resetMove(),this.viewer.resetIdleTimer())}},{key:"__stopMoveInertia",value:function(e,t){var i=this,n=new $i.SplineCurve(this.data.mouseHistory.map(function(e){var t=_slicedToArray(e,3),i=t[1],n=t[2];return new $i.Vector2(i,n)})),o=n.getTangent(1),a=this.data.mouseHistory.reduce(function(e,t){var i=e.total,n=e.prev;return{total:n?i+r({x:n[1],y:n[2]},{x:t[1],y:t[2]})/(t[0]-n[0]):0,prev:t}},{total:0,prev:null}).total/this.data.mouseHistory.length;if(!a)return this.__resetMove(),void this.viewer.resetIdleTimer();this.data.step=3;var s=e,l=t;this.state.animation=new We({properties:{speed:{start:a,end:0}},duration:1e3,easing:"outQuad",onTick:function(e){s+=e.speed*o.x*3*ai.pixelRatio,l+=e.speed*o.y*3*ai.pixelRatio,i.__applyMove(s,l)}}),this.state.animation.then(function(e){i.state.animation=null,e&&(i.__resetMove(),i.viewer.resetIdleTimer())})}},{key:"__doClick",value:function(e,t,i){var n=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.viewer.container.getBoundingClientRect(),a=e-o.left,s=t-o.top,l=this.viewer.renderer.getIntersections({x:a,y:s}),c=l.find(function(e){return e.object.userData[Oe]});if(c){var u=this.viewer.dataHelper.vector3ToSphericalCoords(c.point),h={rightclick:r,target:i,clientX:e,clientY:t,viewerX:a,viewerY:s,yaw:u.yaw,pitch:u.pitch,objects:l.map(function(e){return e.object}).filter(function(e){return!e.userData[Oe]})};try{var d=this.viewer.dataHelper.sphericalCoordsToTextureCoords(h);h.textureX=d.textureX,h.textureY=d.textureY}catch(e){h.textureX=NaN,h.textureY=NaN}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-h.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-h.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new ht(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new st(h)),this.data.dblclickData=T(h),this.data.dblclickTimeout=setTimeout(function(){n.data.dblclickTimeout=null,n.data.dblclickData=null},ke))}}},{key:"__handleObjectsEvents",value:function(e){var t=this;if(!S(this.state.objectsObservers)&&v(e.target,this.viewer.container))for(var i=f(this.viewer.container),n={x:e.clientX-i.x,y:e.clientY-i.y},r=this.viewer.renderer.getIntersections(n),o=function(i,r,o){t.viewer.dispatchEvent(new o(e,i,n,r))},a=function(){var e=_slicedToArray(l[s],2),i=e[0],n=e[1],a=r.find(function(e){return e.object.userData[i]});a?(n&&a.object!==n&&(o(n,i,$t),t.state.objectsObservers[i]=null),n?o(a.object,i,ei):(t.state.objectsObservers[i]=a.object,o(a.object,i,Gt))):n&&(o(n,i,$t),t.state.objectsObservers[i]=null)},s=0,l=Object.entries(this.state.objectsObservers);s<l.length;s++)a()}},{key:"__doMove",value:function(e,t){this.__isStep(1)&&(Math.abs(e-this.data.startMouseX)>=this.moveThreshold||Math.abs(t-this.data.startMouseY)>=this.moveThreshold)?(this.viewer.stopAll(),this.__resetMove(),this.data.step=2,this.data.mouseX=e,this.data.mouseY=t,this.__logMouseMove(e,t)):this.__isStep(2)&&(this.__applyMove(e,t),this.__logMouseMove(e,t))}},{key:"__applyMove",value:function(e,t){var i={yaw:this.config.moveSpeed*((e-this.data.mouseX)/this.state.size.width)*$i.MathUtils.degToRad(this.state.littlePlanet?90:this.state.hFov),pitch:this.config.moveSpeed*((t-this.data.mouseY)/this.state.size.height)*$i.MathUtils.degToRad(this.state.littlePlanet?90:this.state.vFov)},n=this.viewer.getPosition();this.viewer.rotate({yaw:n.yaw-i.yaw,pitch:n.pitch+i.pitch}),this.data.mouseX=e,this.data.mouseY=t}},{key:"__doMoveZoom",value:function(e){if(this.__isStep(2)){e.preventDefault();var t=m(e),i=(t.distance-this.data.pinchDist)/ai.pixelRatio*this.config.zoomSpeed;this.viewer.zoom(this.viewer.getZoomLevel()+i),this.__doMove(t.center.x,t.center.y),this.data.pinchDist=t.distance}}},{key:"__logMouseMove",value:function(e,t){var i=Date.now(),n=this.data.mouseHistory.length?this.data.mouseHistory[this.data.mouseHistory.length-1]:[0,-1,-1];n[1]===e&&n[2]===t?n[0]=i:i===n[0]?(n[1]=e,n[2]=t):this.data.mouseHistory.push([i,e,t]);for(var r=null,o=0;o<this.data.mouseHistory.length;)this.data.mouseHistory[o][0]<i-Se?this.data.mouseHistory.splice(o,1):r&&this.data.mouseHistory[o][0]-r>Se/10?(this.data.mouseHistory.splice(0,o),o=0,r=this.data.mouseHistory[o][0]):(r=this.data.mouseHistory[o][0],o++)}}]),t}(qi),nn=se(),rn=new nn.Vector2,on=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e),n.renderer=new nn.WebGLRenderer({alpha:!0,antialias:!0}),n.renderer.setPixelRatio(ai.pixelRatio),n.renderer.domElement.className="psv-canvas",n.scene=new nn.Scene,n.camera=new nn.PerspectiveCamera(50,16/9,.1,2*Pe),n.mesh=n.viewer.adapter.createMesh(),n.mesh.userData=_defineProperty({},Oe,!0),n.meshContainer=new nn.Group,n.meshContainer.add(n.mesh),n.scene.add(n.meshContainer),n.raycaster=new nn.Raycaster,n.container=document.createElement("div"),n.container.className="psv-canvas-container",n.container.style.background=n.config.canvasBackground,n.container.appendChild(n.renderer.domElement),n.viewer.container.appendChild(n.container),n.viewer.addEventListener(Wt.type,_assertThisInitialized(n)),n.viewer.addEventListener(Zt.type,_assertThisInitialized(n)),n.viewer.addEventListener(Mt.type,_assertThisInitialized(n)),n.viewer.addEventListener(ct.type,_assertThisInitialized(n)),n.hide(),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"panoramaPose",get:function(){return this.mesh.rotation}},{key:"sphereCorrection",get:function(){return this.meshContainer.rotation}},{key:"init",value:function(){var e=this;this.config.mousemove&&(this.container.style.cursor="move"),this.show(),this.renderer.setAnimationLoop(function(t){return e.__renderLoop(t)})}},{key:"destroy",value:function(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(Wt.type,this),this.viewer.removeEventListener(Zt.type,this),this.viewer.removeEventListener(Mt.type,this),this.viewer.removeEventListener(ct.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){switch(e.type){case Wt.type:this.__onSizeUpdated();break;case Zt.type:this.__onZoomUpdated();break;case Mt.type:this.__onPositionUpdated();break;case ct.type:e.containsOptions("fisheye")&&this.__onPositionUpdated(),e.containsOptions("mousemove")&&(this.container.style.cursor=this.config.mousemove?"move":"default"),e.containsOptions("canvasBackground")&&(this.container.style.background=this.config.canvasBackground)}}},{key:"hide",value:function(){this.container.style.opacity="0"}},{key:"show",value:function(){this.container.style.opacity="1"}},{key:"setCustomRenderer",value:function(e){this.customRenderer=e?e(this.renderer):null,this.viewer.needsUpdate()}},{key:"__onSizeUpdated",value:function(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate()}},{key:"__onZoomUpdated",value:function(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate()}},{key:"__onPositionUpdated",value:function(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.viewer.needsUpdate()}},{key:"__renderLoop",value:function(e){var t=this.timestamp?e-this.timestamp:0;this.timestamp=e,this.viewer.dispatchEvent(new nt(e,t)),this.viewer.dynamics.update(t),this.state.needsUpdate&&((this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new zt),this.state.needsUpdate=!1)}},{key:"setTexture",value:function(e){this.state.panoData=e.panoData,this.viewer.adapter.setTexture(this.mesh,e),this.viewer.needsUpdate()}},{key:"setOverlay",value:function(e,t){this.viewer.adapter.setOverlay(this.mesh,e,t),this.viewer.needsUpdate()}},{key:"setPanoramaPose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.mesh,i=this.viewer.dataHelper.cleanPanoramaPose(e);t.rotation.set(-i.tilt,-i.pan,-i.roll,"ZXY")}},{key:"setSphereCorrection",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.meshContainer,i=this.viewer.dataHelper.cleanSphereCorrection(e);t.rotation.set(i.tilt,i.pan,i.roll,"ZXY")}},{key:"transition",value:function(e,t){var i=this,n=H(t),r="zoom"in t,o=new nn.Group,a=this.viewer.adapter.createMesh(.5);if(this.viewer.adapter.setTexture(a,e,!0),this.viewer.adapter.setTextureOpacity(a,0),this.setPanoramaPose(e.panoData,a),this.setSphereCorrection(t.sphereCorrection,o),n){var s=this.viewer.dataHelper.cleanPosition(t),l=this.viewer.getPosition(),c=new nn.Vector3(0,1,0);o.rotateOnWorldAxis(c,s.yaw-l.yaw);var u=new nn.Vector3(0,1,0).cross(this.camera.getWorldDirection(new nn.Vector3)).normalize();o.rotateOnWorldAxis(u,s.pitch-l.pitch)}o.add(a),this.scene.add(o),this.renderer.setRenderTarget(new nn.WebGLRenderTarget),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);var h=new We({properties:{opacity:{start:0,end:1},zoom:r?{start:this.viewer.getZoomLevel(),end:t.zoom}:void 0},duration:t.transition,easing:"outCubic",onTick:function(e){i.viewer.adapter.setTextureOpacity(a,e.opacity),i.viewer.adapter.setTextureOpacity(i.mesh,1-e.opacity),r&&i.viewer.zoom(e.zoom),i.viewer.needsUpdate()}});return h.then(function(r){r?(i.setTexture(e),i.viewer.adapter.setTextureOpacity(i.mesh,1),i.setPanoramaPose(e.panoData),i.setSphereCorrection(t.sphereCorrection),n&&i.viewer.rotate(t)):i.viewer.adapter.disposeTexture(e),i.scene.remove(o),a.geometry.dispose(),a.geometry=null}),h}},{key:"getIntersections",value:function(e){return rn.x=2*e.x/this.state.size.width-1,rn.y=-2*e.y/this.state.size.height+1,this.raycaster.setFromCamera(rn,this.camera),this.raycaster.intersectObjects(this.scene.children,!0).filter(function(e){return e.object.isMesh&&!!e.object.userData})}},{key:"addObject",value:function(e){this.scene.add(e)}},{key:"removeObject",value:function(e){this.scene.remove(e)}},{key:"cleanScene",value:function(e){var t=this;e.traverse(function(i){i.geometry&&i.geometry.dispose(),i.material&&(Array.isArray(i.material)?i.material.forEach(function(e){e.map&&e.map.dispose(),e.dispose()}):(i.material.map&&i.material.map.dispose(),i.material.dispose())),i.dispose&&!_instanceof(i,nn.Scene)&&i.dispose(),i!==e&&t.cleanScene(i)})}}]),t}(qi),an=se(),sn=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e),n.loader=new an.FileLoader,n.loader.setResponseType("blob"),n.config.withCredentials&&n.loader.setWithCredentials(!0),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.abortLoading(),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"abortLoading",value:function(){}},{key:"loadFile",value:function(e,t){var i=this;return this.config.requestHeaders&&this.loader.setRequestHeader(this.config.requestHeaders(e)),new Promise(function(n,r){var o=0;null==t||t(o),i.loader.load(e,function(e){o=100,null==t||t(o),n(e)},function(e){if(e.lengthComputable){var i=e.loaded/e.total*100;i>o&&(o=i,null==t||t(o))}},function(e){r(e)})})}},{key:"loadImage",value:function(e,t){return this.loadFile(e,t).then(function(e){return new Promise(function(t,i){var n=document.createElement("img");n.onload=function(){URL.revokeObjectURL(n.src),t(n)},n.onerror=i,n.src=URL.createObjectURL(e)})})}},{key:"preloadPanorama",value:function(e){return this.viewer.adapter.supportsPreload(e)?this.viewer.adapter.loadTexture(e):Promise.reject(new He("Current adapter does not support preload"))}}]),t}(qi),ln=se(),cn=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e),n.zoom=new Be(function(e){n.viewer.state.vFov=n.viewer.dataHelper.zoomLevelToFov(e),n.viewer.state.hFov=n.viewer.dataHelper.vFovToHFov(n.viewer.state.vFov),n.viewer.dispatchEvent(new Zt(e))},{defaultValue:n.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),n.position=new Xe(function(e){n.viewer.dataHelper.sphericalCoordsToVector3(e,n.viewer.state.direction),n.viewer.dispatchEvent(new Mt(e))},{yaw:new Be(null,{defaultValue:n.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new Be(null,{defaultValue:n.config.defaultPitch,min:n.viewer.state.littlePlanet?0:-Math.PI/2,max:n.viewer.state.littlePlanet?2*Math.PI:Math.PI/2,wrap:n.viewer.state.littlePlanet})}),n.updateSpeeds(),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"updateSpeeds",value:function(){this.zoom.setSpeed(50*this.config.zoomSpeed),this.position.setSpeed(ln.MathUtils.degToRad(50*this.config.moveSpeed))}},{key:"update",value:function(e){this.zoom.update(e),this.position.update(e)}}]),t}(qi),un=se(),hn=_createClass(function e(){_classCallCheck(this,e),this.ready=!1,this.needsUpdate=!1,this.keyboardEnabled=!1,this.direction=new un.Vector3(0,0,Pe),this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.littlePlanet=!1,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0},this.panoData={fullWidth:0,fullHeight:0,croppedWidth:0,croppedHeight:0,croppedX:0,croppedY:0,poseHeading:0,posePitch:0,poseRoll:0}}),dn=function(e){function t(e){var n;_classCallCheck(this,t),n=i.call(this),n.plugins={},n.children=[],n.onResize=k(function(){return n.navbar.autoSize()},500),ai.load(),n.state=new hn,n.config=Ai(e),n.parent=c(e.container),n.parent[Oe]=_assertThisInitialized(n),n.container=document.createElement("div"),n.container.classList.add("psv-container"),n.parent.appendChild(n.container),n.adapter=new n.config.adapter[0](_assertThisInitialized(n),n.config.adapter[1]),n.renderer=new on(_assertThisInitialized(n)),n.textureLoader=new sn(_assertThisInitialized(n)),n.eventsHandler=new tn(_assertThisInitialized(n)),n.dataHelper=new Qi(_assertThisInitialized(n)),n.dynamics=new cn(_assertThisInitialized(n)),n.loader=new Di(_assertThisInitialized(n)),n.navbar=new Vi(_assertThisInitialized(n)),n.panel=new Yi(_assertThisInitialized(n)),n.notification=new ji(_assertThisInitialized(n)),n.overlay=new Ui(_assertThisInitialized(n)),n.resize(n.config.size),x(ai.isTouchEnabled,function(e){u(n.container,"psv--is-touch",e)}),n.config.plugins.forEach(function(e){var t=_slicedToArray(e,2),i=t[0],r=t[1];n.plugins[i.id]=new i(_assertThisInitialized(n),r)});for(var r=0,o=Object.values(n.plugins);r<o.length;r++){var a,s=o[r];null===(a=s.init)||void 0===a||a.call(s)}return n.config.navbar&&n.navbar.setButtons(n.config.navbar),n.config.panorama?n.setPanorama(n.config.panorama):n.loader.show(),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(var e=0,t=Object.entries(this.plugins);e<t.length;e++){var i=_slicedToArray(t[e],2),n=i[0],r=i[1];r.destroy(),delete this.plugins[n]}this.children.slice().forEach(function(e){return e.destroy()}),this.children.length=0,this.eventsHandler.destroy(),this.renderer.destroy(),this.textureLoader.destroy(),this.dataHelper.destroy(),this.adapter.destroy(),this.dynamics.destroy(),this.parent.removeChild(this.container),delete this.parent[Oe]}},{key:"init",value:function(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&(this.container.classList.add("psv--has-navbar"),this.navbar.show()),"always"===this.config.keyboard&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new xt)}},{key:"resetIdleTimer",value:function(){this.state.idleTime=performance.now()}},{key:"disableIdleTimer",value:function(){this.state.idleTime=-1}},{key:"getPlugin",value:function(e){if("string"==typeof e)return this.plugins[e];var t=$(e);return t?this.plugins[t.id]:null}},{key:"getPosition",value:function(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}},{key:"getZoomLevel",value:function(){return this.dynamics.zoom.current}},{key:"getSize",value:function(){return{...this.state.size}}},{key:"isFullscreenEnabled",value:function(){return g(this.container)}},{key:"needsUpdate",value:function(){this.state.needsUpdate=!0}},{key:"autoSize",value:function(){this.container.clientWidth===this.state.size.width&&this.container.clientHeight===this.state.size.height||(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new Wt(this.getSize())),this.onResize())}},{key:"setPanorama",value:function(e){var t,i=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.textureLoader.abortLoading(),null===(t=this.state.transitionAnimation)||void 0===t||t.cancel(),this.state.ready||["sphereCorrection","panoData","overlay","overlayOpacity"].forEach(function(e){e in n||(n[e]=i.config[e])}),void 0!==n.transition&&!0!==n.transition||(n.transition=_e),void 0===n.showLoader&&(n.showLoader=!0),void 0===n.caption&&(n.caption=this.config.caption),void 0===n.description&&(n.description=this.config.description),n.panoData||"function"!=typeof this.config.panoData||(n.panoData=this.config.panoData);var r=H(n),o="zoom"in n;(r||o)&&this.stopAll(),this.hideError(),this.resetIdleTimer(),this.config.panorama=e,this.config.caption=n.caption,this.config.description=n.description;var a=function(e){if(i.loader.hide(),i.state.loadingPromise=null,A(e))return!1;if(e)throw i.navbar.setCaption(""),i.showError(i.config.lang.loadError),console.error(e),e;return i.setOverlay(n.overlay,n.overlayOpacity),i.navbar.setCaption(i.config.caption),!0};this.navbar.setCaption("<em>".concat(this.config.loadingTxt||"","</em>")),!n.showLoader&&this.state.ready||this.loader.show();var s=this.adapter.loadTexture(this.config.panorama,n.panoData).then(function(e){if(e.panorama!==i.config.panorama)throw i.adapter.disposeTexture(e),z();return e});return n.transition&&this.state.ready&&this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=s.then(function(e){return i.loader.hide(),i.dispatchEvent(new Pt(e)),i.state.transitionAnimation=i.renderer.transition(e,n),i.state.transitionAnimation}).then(function(e){if(i.state.transitionAnimation=null,!e)throw z()}).then(function(){return a()},function(e){return a(e)}):this.state.loadingPromise=s.then(function(e){i.renderer.show(),i.renderer.setTexture(e),i.renderer.setPanoramaPose(e.panoData),i.renderer.setSphereCorrection(n.sphereCorrection),i.dispatchEvent(new Pt(e)),o&&i.zoom(n.zoom),r&&i.rotate(n),i.state.ready||i.init()}).then(function(){return a()},function(e){return a(e)}),this.state.loadingPromise}},{key:"setOverlay",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.config.overlayOpacity,n=this.adapter.constructor.supportsOverlay;return e?n?this.adapter.loadTexture(e,function(e){var i=t.state.panoData,n=e.width/i.croppedWidth;return{fullWidth:n*i.fullWidth,fullHeight:n*i.fullHeight,croppedWidth:n*i.croppedWidth,croppedHeight:n*i.croppedHeight,croppedX:n*i.croppedX,croppedY:n*i.croppedY}},!1).then(function(e){t.renderer.setOverlay(e,i)}):Promise.reject(new He("Current adapter does not supports overlay")):(n&&this.renderer.setOverlay(null,0),Promise.resolve())}},{key:"setOptions",value:function(e){for(var t={...this.config,...e},i=0,n=Object.entries(e);i<n.length;i++){var r=_slicedToArray(n[i],2),o=r[0],a=r[1];if(o in xi)if(o in Ii)R(Ii[o]);else switch(o in zi&&(a=zi[o](a,{rawConfig:t,defValue:xi[o]})),this.config[o]=a,o){case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new Zt(this.getZoomLevel()));break;case"keyboard":"always"===this.config.keyboard?this.startKeyboardControl():this.stopKeyboardControl()}else R("Unknown option ".concat(o))}this.needsUpdate(),this.dispatchEvent(new ct(Object.keys(e)))}},{key:"setOption",value:function(e,t){this.setOptions(_defineProperty({},e,t))}},{key:"showError",value:function(e){this.overlay.show({id:Le.ERROR,image:Xi,title:e,dissmisable:!1})}},{key:"hideError",value:function(){this.overlay.hide(Le.ERROR)}},{key:"rotate",value:function(e){var t=new ot(this.dataHelper.cleanPosition(e));this.dispatchEvent(t),t.defaultPrevented||this.dynamics.position.setValue(t.position)}},{key:"zoom",value:function(e){this.dynamics.zoom.setValue(e)}},{key:"zoomIn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.dynamics.zoom.step(e)}},{key:"zoomOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.dynamics.zoom.step(-e)}},{key:"animate",value:function(e){var t=this,i=H(e),n=void 0!==e.zoom,r=new tt(i?this.dataHelper.cleanPosition(e):void 0,e.zoom);if(this.dispatchEvent(r),!r.defaultPrevented){var o=r.position,l=r.zoomLevel;this.stopAll();var c,u={};if(i){var h=this.getPosition(),d=a(h.yaw,o.yaw);u.yaw={start:h.yaw,end:h.yaw+d},u.pitch={start:h.pitch,end:o.pitch},c=this.dataHelper.speedToDuration(e.speed,s(h,o))}if(n){var v=Math.abs(l-this.getZoomLevel());u.zoom={start:this.getZoomLevel(),end:l},c||(c=this.dataHelper.speedToDuration(e.speed,Math.PI/4*v/100))}return c?(this.state.animation=new We({properties:u,duration:Math.max(we,c),easing:"inOutSine",onTick:function(e){i&&t.dynamics.position.setValue({yaw:e.yaw,pitch:e.pitch}),n&&t.dynamics.zoom.setValue(e.zoom)}}),this.state.animation.then(function(){t.state.animation=null,t.resetIdleTimer()}),this.state.animation):(i&&this.rotate(o),n&&this.zoom(l),new We(null))}}},{key:"stopAnimation",value:function(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}},{key:"resize",value:function(e){var t=this,i=e;["width","height"].forEach(function(n){e&&i[n]&&(/^[0-9.]+$/.test(i[n])&&(i[n]+="px"),t.parent.style[n]=i[n])}),this.autoSize()}},{key:"enterFullscreen",value:function(){this.isFullscreenEnabled()||_(this.container)}},{key:"exitFullscreen",value:function(){this.isFullscreenEnabled()&&w()}},{key:"toggleFullscreen",value:function(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}},{key:"startKeyboardControl",value:function(){this.state.keyboardEnabled=!0}},{key:"stopKeyboardControl",value:function(){this.state.keyboardEnabled=!1}},{key:"createTooltip",value:function(e){return new Bi(this,e)}},{key:"observeObjects",value:function(e){this.state.objectsObservers[e]=null}},{key:"unobserveObjects",value:function(e){delete this.state.objectsObservers[e]}},{key:"stopAll",value:function(){return this.dispatchEvent(new Bt),this.disableIdleTimer(),this.stopAnimation()}}]),t}($e);ae(te(e,"__esModule",{value:!0}),le)}),function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports,require("three"),require("@photo-sphere-viewer/core")):"function"==typeof define&&define.amd?define(["exports","three","@photo-sphere-viewer/core"],t):(e="undefined"!=typeof globalThis?globalThis:e||self,t((e.PhotoSphereViewer=e.PhotoSphereViewer||{},e.PhotoSphereViewer.AutorotatePlugin={}),e.THREE,e.PhotoSphereViewer))}(window,function(e,t,i){function n(e){return[e.yaw,e.pitch]}var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,l=function(e,t){for(var i in t)r(e,i,{get:t[i],enumerable:!0})},c=function(e,t,i,n){if(t&&"object"===_typeof(t)||"function"==typeof t){var l,c=_createForOfIteratorHelper(a(t));try{var u=function(){var a=l.value;s.call(e,a)||a===i||r(e,a,{get:function(){return t[a]},enumerable:!(n=o(t,a))||n.enumerable})};for(c.s();!(l=c.n()).done;)u()}catch(e){c.e(e)}finally{c.f()}}return e},u=function(){return i},h=function(){return t},d={};l(d,{AutorotatePlugin:function(){return S},events:function(){return f}});var v=u(),p=u(),f={};l(f,{AutorotateEvent:function(){return g}});var y=u(),m=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.autorotateEnabled=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(y.TypedEvent),g=m;g.type="autorotate"
;var _='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 41 41" overflow="visible"><g fill="currentColor" transform-origin="center" transform="scale(1.3)"><path d="M40.5 14.1c-.1-.1-1.2-.5-2.898-1-.102 0-.202-.1-.202-.2C34.5 6.5 28 2 20.5 2S6.6 6.5 3.7 12.9c0 .1-.1.1-.2.2-1.7.6-2.8 1-2.9 1l-.6.3v12.1l.6.2c.1 0 1.1.399 2.7.899.1 0 .2.101.2.199C6.3 34.4 12.9 39 20.5 39c7.602 0 14.102-4.6 16.9-11.1 0-.102.1-.102.199-.2 1.699-.601 2.699-1 2.801-1l.6-.3V14.3l-.5-.2zM6.701 11.5C9.7 7 14.8 4 20.5 4c5.8 0 10.9 3 13.8 7.5.2.3-.1.6-.399.5-3.799-1-8.799-2-13.6-2-4.7 0-9.5 1-13.2 2-.3.1-.5-.2-.4-.5zM25.1 20.3L18.7 24c-.3.2-.7 0-.7-.5v-7.4c0-.4.4-.6.7-.4l6.399 3.8c.301.1.301.6.001.8zm9.4 8.901A16.421 16.421 0 0 1 20.5 37c-5.9 0-11.1-3.1-14-7.898-.2-.302.1-.602.4-.5 3.9 1 8.9 2.1 13.6 2.1 5 0 9.9-1 13.602-2 .298-.1.5.198.398.499z"/></g><!--Created by Nick Bluth from the Noun Project--></svg>\n',w='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 41 41" overflow="visible"><g fill="currentColor" transform-origin="center" transform="scale(1.3)"><path d="M40.5 14.1c-.1-.1-1.2-.5-2.899-1-.101 0-.2-.1-.2-.2C34.5 6.5 28 2 20.5 2S6.6 6.5 3.7 12.9c0 .1-.1.1-.2.2-1.7.6-2.8 1-2.9 1l-.6.3v12.1l.6.2c.1 0 1.1.4 2.7.9.1 0 .2.1.2.199C6.3 34.4 12.9 39 20.5 39c7.601 0 14.101-4.6 16.9-11.1 0-.101.1-.101.2-.2 1.699-.6 2.699-1 2.8-1l.6-.3V14.3l-.5-.2zM20.5 4c5.8 0 10.9 3 13.8 7.5.2.3-.1.6-.399.5-3.8-1-8.8-2-13.6-2-4.7 0-9.5 1-13.2 2-.3.1-.5-.2-.4-.5C9.7 7 14.8 4 20.5 4zm0 33c-5.9 0-11.1-3.1-14-7.899-.2-.301.1-.601.4-.5 3.9 1 8.9 2.1 13.6 2.1 5 0 9.9-1 13.601-2 .3-.1.5.2.399.5A16.422 16.422 0 0 1 20.5 37zm18.601-12.1c0 .1-.101.3-.2.3-2.5.9-10.4 3.6-18.4 3.6-7.1 0-15.6-2.699-18.3-3.6C2.1 25.2 2 25 2 24.9V16c0-.1.1-.3.2-.3 2.6-.9 10.6-3.6 18.2-3.6 7.5 0 15.899 2.7 18.5 3.6.1 0 .2.2.2.3v8.9z"/><path d="M18.7 24l6.4-3.7c.3-.2.3-.7 0-.8l-6.4-3.8c-.3-.2-.7 0-.7.4v7.4c0 .5.4.7.7.5z"/></g><!--Created by Nick Bluth from the Noun Project--></svg>\n',b=function(e){function t(e){var n,r;return _classCallCheck(this,t),r=i.call(this,e,{className:"psv-autorotate-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:w,iconActive:_}),r.plugin=r.viewer.getPlugin("autorotate"),null===(n=r.plugin)||void 0===n||n.addEventListener(g.type,_assertThisInitialized(r)),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){var e;null===(e=this.plugin)||void 0===e||e.removeEventListener(g.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"isSupported",value:function(){return!!this.plugin}},{key:"handleEvent",value:function(e){_instanceof(e,g)&&this.toggleActive(e.autorotateEnabled)}},{key:"onClick",value:function(){this.plugin.isEnabled()&&(this.plugin.config.autostartOnIdle=!1),this.plugin.toggle()}}]),t}(p.AbstractButton);b.id="autorotate";var k=u(),E=h(),C=k.utils.getConfigParser({autostartDelay:2e3,autostartOnIdle:!0,autorotateSpeed:k.utils.parseSpeed("2rpm"),autorotatePitch:null,autorotateZoomLvl:null,keypoints:null,startFromClosest:!0},{autostartOnIdle:function(e,t){var i=t.rawConfig;return e&&k.utils.isNil(i.autostartDelay)?(k.utils.logWarn("autostartOnIdle requires a non null autostartDelay"),!1):e},autorotateSpeed:function(e){return k.utils.parseSpeed(e)},autorotatePitch:function(e){return k.utils.isNil(e)?null:k.utils.parseAngle(e,!0)},autorotateZoomLvl:function(e){return k.utils.isNil(e)?null:E.MathUtils.clamp(e,0,100)}}),T=16,S=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,e,n),r.state={initialStart:!0,enabled:!1,idx:-1,curve:[],startStep:null,endStep:null,startTime:null,stepDuration:null,remainingPause:null,lastTime:null,tooltip:null},r.state.initialStart=!k.utils.isNil(r.config.autostartDelay),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"init",value:function(){_get(_getPrototypeOf(t.prototype),"init",this).call(this),this.video=this.viewer.getPlugin("video"),this.markers=this.viewer.getPlugin("markers"),this.config.keypoints&&(this.setKeypoints(this.config.keypoints),delete this.config.keypoints),this.viewer.addEventListener(k.events.StopAllEvent.type,this),this.viewer.addEventListener(k.events.BeforeRenderEvent.type,this),this.video||this.viewer.addEventListener(k.events.KeypressEvent.type,this)}},{key:"destroy",value:function(){this.viewer.removeEventListener(k.events.StopAllEvent.type,this),this.viewer.removeEventListener(k.events.BeforeRenderEvent.type,this),this.viewer.removeEventListener(k.events.KeypressEvent.type,this),delete this.video,delete this.markers,delete this.keypoints,_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){switch(e.type){case k.events.StopAllEvent.type:this.stop();break;case k.events.BeforeRenderEvent.type:this.__beforeRender(e.timestamp);break;case k.events.KeypressEvent.type:e.key===k.CONSTANTS.KEY_CODES.Space&&(this.toggle(),e.preventDefault())}}},{key:"setKeypoints",value:function(e){var t=this;if(e){if(e.length<2)throw new k.PSVError("At least two points are required");this.keypoints=e.map(function(e,i){var r,o={position:null,markerId:null,pause:0,tooltip:null};if("string"==typeof e?o.markerId=e:k.utils.isExtendedPosition(e)?r=e:(o.markerId=e.markerId,o.pause=e.pause,r=e.position,e.tooltip&&"object"===_typeof(e.tooltip)?o.tooltip=e.tooltip:"string"==typeof e.tooltip&&(o.tooltip={content:e.tooltip})),o.markerId){if(!t.markers)throw new k.PSVError("Keypoint #".concat(i," references a marker but the markers plugin is not loaded"));var a=t.markers.getMarker(o.markerId);o.position=n(a.state.position)}else{if(!r)throw new k.PSVError("Keypoint #".concat(i," is missing marker or position"));o.position=n(t.viewer.dataHelper.cleanPosition(r))}return o})}else this.keypoints=null;this.isEnabled()&&(this.stop(),this.start())}},{key:"isEnabled",value:function(){return this.state.enabled}},{key:"start",value:function(){this.isEnabled()||(this.viewer.stopAll(),this.keypoints?this.config.startFromClosest&&this.__shiftKeypoints():this.__animate(),this.state.initialStart=!1,this.state.enabled=!0,this.dispatchEvent(new g(!0)))}},{key:"stop",value:function(){this.isEnabled()&&(this.__reset(),this.__hideTooltip(),this.viewer.dynamics.position.stop(),this.viewer.dynamics.zoom.stop(),this.state.enabled=!1,this.dispatchEvent(new g(!1)))}},{key:"toggle",value:function(){this.isEnabled()?this.stop():this.start()}},{key:"reverse",value:function(){this.isEnabled()&&!this.keypoints&&(this.config.autorotateSpeed=-this.config.autorotateSpeed,this.__animate())}},{key:"__animate",value:function(){var e,t=this;e=k.utils.isNil(this.config.autorotateZoomLvl)?Promise.resolve():this.viewer.animate({zoom:this.config.autorotateZoomLvl,speed:"".concat(2*this.viewer.config.zoomSpeed,"rpm")}),e.then(function(){var e;t.viewer.dynamics.position.roll({yaw:t.config.autorotateSpeed<0},Math.abs(t.config.autorotateSpeed/t.viewer.config.moveSpeed)),t.viewer.dynamics.position.goto({pitch:null!==(e=t.config.autorotatePitch)&&void 0!==e?e:t.viewer.config.defaultPitch},Math.abs(t.config.autorotateSpeed/t.viewer.config.moveSpeed))})}},{key:"__reset",value:function(){this.state.idx=-1,this.state.curve=[],this.state.startStep=null,this.state.endStep=null,this.state.startTime=null,this.state.stepDuration=null,this.state.remainingPause=null,this.state.lastTime=null,this.state.tooltip=null}},{key:"__beforeRender",value:function(e){(this.state.initialStart||this.config.autostartOnIdle)&&this.viewer.state.idleTime>0&&e-this.viewer.state.idleTime>this.config.autostartDelay&&this.start(),this.isEnabled()&&this.keypoints&&(this.state.startTime||(this.state.endStep=n(this.viewer.getPosition()),this.__nextStep(),this.state.startTime=e,this.state.lastTime=e),this.__nextFrame(e))}},{key:"__shiftKeypoints",value:function(){var e,t=n(this.viewer.getPosition()),i=this.__findMinIndex(this.keypoints,function(e){return k.utils.greatArcDistance(e.position,t)});(e=this.keypoints).push.apply(e,_toConsumableArray(this.keypoints.splice(0,i)))}},{key:"__incrementIdx",value:function(){this.state.idx++,this.state.idx===this.keypoints.length&&(this.state.idx=0)}},{key:"__showTooltip",value:function(){var e=this.keypoints[this.state.idx];if(e.tooltip){var t=this.viewer.dataHelper.vector3ToViewerCoords(this.viewer.state.direction);this.state.tooltip=this.viewer.createTooltip({content:e.tooltip.content,position:e.tooltip.position,top:t.y,left:t.x})}else if(e.markerId){var i=this.markers.getMarker(e.markerId);i.showTooltip(),this.state.tooltip=i.tooltip}}},{key:"__hideTooltip",value:function(){if(this.state.tooltip){var e=this.keypoints[this.state.idx];if(e.tooltip)this.state.tooltip.hide();else if(e.markerId){var t=this.markers.getMarker(e.markerId);t.hideTooltip()}this.state.tooltip=null}}},{key:"__nextPoint",value:function(){var e=[];if(-1===this.state.idx){var t=n(this.viewer.getPosition());e.push(t,t,this.keypoints[0].position,this.keypoints[1].position)}else for(var i=-1;i<3;i++){var r=this.state.idx+i<0?this.keypoints[this.keypoints.length-1]:this.keypoints[(this.state.idx+i)%this.keypoints.length];e.push(r.position)}for(var o=[new E.Vector2(e[0][0],e[0][1])],a=0,s=1;s<=3;s++){var l=e[s-1][0]-e[s][0];l>Math.PI?a+=1:l<-Math.PI&&(a-=1),0!==a&&1===s&&(o[0].x-=2*a*Math.PI,a=0),o.push(new E.Vector2(e[s][0]+2*a*Math.PI,e[s][1]))}var c=new E.SplineCurve(o).getPoints(3*T).map(function(e){return[e.x,e.y]});this.state.curve=c.slice(T+1,2*T+1),-1!==this.state.idx?(this.state.remainingPause=this.keypoints[this.state.idx].pause,this.state.remainingPause?this.__showTooltip():this.__incrementIdx()):this.__incrementIdx()}},{key:"__nextStep",value:function(){0===this.state.curve.length&&(this.__nextPoint(),this.state.endStep[0]=k.utils.parseAngle(this.state.endStep[0])),this.state.startStep=this.state.endStep,this.state.endStep=this.state.curve.shift();var e=k.utils.greatArcDistance(this.state.startStep,this.state.endStep);this.state.stepDuration=1e3*e/Math.abs(this.config.autorotateSpeed),0===e&&this.__nextStep()}},{key:"__nextFrame",value:function(e){var t=e-this.state.lastTime;if(this.state.lastTime=e,this.state.remainingPause){if(this.state.remainingPause=Math.max(0,this.state.remainingPause-t),this.state.remainingPause>0)return;this.__hideTooltip(),this.__incrementIdx(),this.state.startTime=e}var i=(e-this.state.startTime)/this.state.stepDuration;i>=1&&(this.__nextStep(),i=0,this.state.startTime=e),this.viewer.rotate({yaw:this.state.startStep[0]+(this.state.endStep[0]-this.state.startStep[0])*i,pitch:this.state.startStep[1]+(this.state.endStep[1]-this.state.startStep[1])*i})}},{key:"__findMinIndex",value:function(e,t){var i=0,n=Number.MAX_VALUE;return e.forEach(function(e,r){var o=t(e);o<n&&(n=o,i=r)}),i}}]),t}(k.AbstractConfigurablePlugin);S.id="autorotate",S.configParser=C,S.readonlyOptions=["keypoints"],(0,v.registerButton)(b,"start"),v.DEFAULTS.lang[b.id]="Automatic rotation",c(r(e,"__esModule",{value:!0}),d)}),function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports,require("three"),require("@photo-sphere-viewer/core")):"function"==typeof define&&define.amd?define(["exports","three","@photo-sphere-viewer/core"],t):(e="undefined"!=typeof globalThis?globalThis:e||self,t((e.PhotoSphereViewer=e.PhotoSphereViewer||{},e.PhotoSphereViewer.GalleryPlugin={}),e.THREE,e.PhotoSphereViewer))}(window,function(e,t,i){var n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,s=function(e,t){for(var i in t)n(e,i,{get:t[i],enumerable:!0})},l=function(e,t,i,s){if(t&&"object"===_typeof(t)||"function"==typeof t){var l,c=_createForOfIteratorHelper(o(t));try{var u=function(){var o=l.value;a.call(e,o)||o===i||n(e,o,{get:function(){return t[o]},enumerable:!(s=r(t,o))||s.enumerable})};for(c.s();!(l=c.n()).done;)u()}catch(e){c.e(e)}finally{c.f()}}return e},c=function(){return i},u={};s(u,{GalleryPlugin:function(){return L},events:function(){return d}});var h=c(),d={};s(d,{HideGalleryEvent:function(){return y},ShowGalleryEvent:function(){return f}});var v=c(),p=function(e){function t(){return _classCallCheck(this,t),i.call(this,t.type)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(v.TypedEvent),f=p;f.type="show-gallery";var y=function(e){function t(){return _classCallCheck(this,t),i.call(this,f.type)}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(v.TypedEvent);y.type="hide-gallery";var m=c(),g='<svg viewBox="185 115 330 330" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M186.7 326.7V163.3c0-15 8.3-23.3 23.3-23.3h210c15 0 23.3 8.3 23.3 23.3v163.4c0 15-8.3 23.3-23.3 23.3H210c-15 0-23.3-8.3-23.3-23.3zm70 70v-23.4H420c30.2 0 46.7-16.4 46.7-46.6V210H490c15 0 23.3 8.3 23.3 23.3v163.4c0 15-8.3 23.3-23.3 23.3H280c-15 0-23.3-8.3-23.3-23.3zm-23.8-105H397l-40-50.4-26.7 29.7-44.3-54.5zm106.7-76c9.6 0 17.8-7.8 17.8-17.2a18 18 0 0 0-17.8-17.8c-9.4 0-17.2 8.2-17.2 17.8 0 9.4 7.8 17.2 17.2 17.2z"/><!--Created by Wolf Böse from the Noun Project--></svg>',_=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-gallery-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:g}),n.plugin=n.viewer.getPlugin("gallery"),n.plugin&&(n.plugin.addEventListener(f.type,_assertThisInitialized(n)),n.plugin.addEventListener(y.type,_assertThisInitialized(n))),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.plugin&&(this.plugin.removeEventListener(f.type,this),this.plugin.removeEventListener(y.type,this)),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){_instanceof(e,f)?this.toggleActive(!0):_instanceof(e,y)&&this.toggleActive(!1)}},{key:"isSupported",value:function(){return!!this.plugin}},{key:"onClick",value:function(){this.plugin.toggle()}}]),t}(m.AbstractButton);_.id="gallery";var w=c(),b=c(),k=c(),E="psvGalleryItem",C=k.utils.dasherize(E),T="psv-gallery-item--active",S=function(e,t){return"\n".concat(e.map(function(e){return'\n<div class="psv-gallery-item" data-'.concat(C,'="').concat(e.id,'" style="width:').concat(t.width,'px">\n<div class="psv-gallery-item-wrapper" style="padding-bottom:calc(100% * ').concat(t.height," / ").concat(t.width,')">\n  ').concat(e.name?'<div class="psv-gallery-item-title"><span>'.concat(e.name,"</span></div>"):"",'\n  <svg class="psv-gallery-item-thumb" viewBox="0 0 200 200" preserveAspectRatio="xMidYMid slice"><use href="#psvGalleryBlankIcon"></use></svg>\n  ').concat(e.thumbnail?'<div class="psv-gallery-item-thumb" data-src="'.concat(e.thumbnail,'"></div>'):"","\n</div>\n</div>\n")}).join(""),"\n")},P='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">\n  <defs>\n    <symbol id="psvGalleryBlankIcon" viewBox="0 0 200 200">\n      <rect x="0" y="0" width="200" height="200" fill="#666"/>\n      <g transform="scale(0.25) translate(25 20) " fill="#eee">\n        <path d="M376 220.61c-85.84 0-155.39 69.56-155.39 155.39 0 85.84 69.56 155.39 155.39 155.39 85.84 0 155.39-69.56 155.39-155.39 0-85.84-69.56-155.39-155.39-155.39zm0 300.92c-80.41 0-145.53-65.12-145.53-145.53S295.59 230.47 376 230.47 521.53 295.59 521.53 376 456.41 521.53 376 521.53z"/>\n        <path d="M467.27 300.03H284.74a18.21 18.21 0 0 0-18.25 18.25v115.43a18.21 18.21 0 0 0 18.25 18.26h182.53a18.21 18.21 0 0 0 18.25-18.26V318.28a18.2 18.2 0 0 0-18.25-18.25zm-190.91 18.25a8.64 8.64 0 0 1 8.39-8.38h182.53a8.64 8.64 0 0 1 8.38 8.38V413l-44.89-35.52c-.49-.5-.99-.5-1.48-.99h-2.46c-.5 0-1 0-1.48.5l-37.5 21.2-43.9-58.7-.5-.5s0-.48-.49-.48c0 0-.49 0-.49-.5-.49 0-.49-.49-.99-.49-.49 0-.49 0-.98-.49H337.53c-.5 0-.5.5-.99.5h-.49l-.5.48s-.48 0-.48.5l-58.7 65.12zM467.27 442.1H284.74a8.64 8.64 0 0 1-8.39-8.38v-15.3l63.15-68.07 42.92 57.22 1.48 1.48h.49c.5.5 1.48.5 1.97.5H388.83l38.47-21.72 46.37 36.5c.5.5 1.49 1 1.98 1v8.88c0 3.95-3.45 7.9-8.38 7.9z"/>\n        <path d="M429.77 333.58a13.81 13.81 0 1 1-27.63 0 13.81 13.81 0 0 1 27.63 0"/>\n      </g>\n    </symbol>\n  </defs>\n</svg>',O=function(e){function t(e,n){var r;_classCallCheck(this,t),r=i.call(this,n,{className:"psv-gallery psv--capture-event"}),r.plugin=e,r.state={visible:!0,mousedown:!1,initMouseX:null,mouseX:null},r.container.innerHTML=P,r.container.querySelector("svg").style.display="none";var o=document.createElement("div");return o.className="psv-panel-close-button",o.innerHTML=b.CONSTANTS.ICONS.close,r.container.appendChild(o),r.items=document.createElement("div"),r.items.className="psv-gallery-container",r.container.appendChild(r.items),r.observer=new IntersectionObserver(function(e){e.forEach(function(e){if(e.intersectionRatio>0){var t=e.target;t.style.backgroundImage="url(".concat(t.dataset.src,")"),delete t.dataset.src,r.observer.unobserve(e.target)}})},{root:r.viewer.container}),r.container.addEventListener("wheel",_assertThisInitialized(r)),r.container.addEventListener("mousedown",_assertThisInitialized(r)),r.container.addEventListener("mousemove",_assertThisInitialized(r)),r.container.addEventListener("click",_assertThisInitialized(r)),window.addEventListener("mouseup",_assertThisInitialized(r)),o.addEventListener("click",function(){return r.plugin.hide()}),r.hide(),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){window.removeEventListener("mouseup",this),this.observer.disconnect(),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){switch(e.type){case"wheel":this.container.scrollLeft+=50*e.deltaY,e.preventDefault();break;case"mousedown":this.state.mousedown=!0,this.state.initMouseX=e.clientX,this.state.mouseX=e.clientX;break;case"mousemove":if(this.state.mousedown){var t=this.state.mouseX-e.clientX;this.container.scrollLeft+=t,this.state.mouseX=e.clientX}break;case"mouseup":this.state.mousedown=!1,this.state.mouseX=null,e.preventDefault();break;case"click":if(Math.abs(this.state.initMouseX-e.clientX)<10){var i=b.utils.getClosest(e.target,"[data-".concat(C,"]"));i&&this.plugin.__click(i.dataset[E])}}}},{key:"show",value:function(){this.container.classList.add("psv-gallery--open"),this.state.visible=!0}},{key:"hide",value:function(){this.container.classList.remove("psv-gallery--open"),this.state.visible=!1}},{key:"setItems",value:function(e){var t=this;this.items.innerHTML=S(e,this.plugin.config.thumbnailSize),this.observer&&(this.observer.disconnect(),this.items.querySelectorAll("[data-src]").forEach(function(e){t.observer.observe(e)}))}},{key:"setActive",value:function(e){var t=this.items.querySelector("."+T);if(null==t||t.classList.remove(T),e){var i=this.items.querySelector("[data-".concat(C,'="').concat(e,'"]'));null==i||i.classList.add(T)}}}]),t}(b.AbstractComponent),M=w.utils.getConfigParser({items:[],visibleOnLoad:!1,hideOnClick:!0,thumbnailSize:{width:200,height:100}}),L=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,e,n),r.items=[],r.gallery=new O(_assertThisInitialized(r),r.viewer),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"init",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"init",this).call(this),this.viewer.addEventListener(w.events.PanoramaLoadedEvent.type,this),this.viewer.addEventListener(w.events.ShowPanelEvent.type,this),this.config.visibleOnLoad&&this.viewer.addEventListener(w.events.ReadyEvent.type,function(){e.show()},{once:!0}),this.setItems(this.config.items),delete this.config.items,setTimeout(function(){return e.__updateButton()})}},{key:"destroy",value:function(){this.viewer.removeEventListener(w.events.PanoramaLoadedEvent.type,this),this.viewer.removeEventListener(w.events.ShowPanelEvent.type,this),this.gallery.destroy(),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"setOptions",value:function(e){_get(_getPrototypeOf(t.prototype),"setOptions",this).call(this,e),e.thumbnailSize&&this.gallery.setItems(this.items)}},{key:"handleEvent",value:function(e){if(_instanceof(e,w.events.PanoramaLoadedEvent)){var t=this.items.find(function(t){return w.utils.deepEqual(t.panorama,e.data.panorama)});this.currentId=null==t?void 0:t.id,this.gallery.setActive(null==t?void 0:t.id)}else _instanceof(e,w.events.ShowPanelEvent)&&this.gallery.isVisible()&&this.hide()}},{key:"show",value:function(){return this.dispatchEvent(new f),this.gallery.show()}},{key:"hide",value:function(){return this.dispatchEvent(new y),this.gallery.hide()}},{key:"toggle",value:function(){this.gallery.isVisible()?this.hide():this.show()}},{key:"setItems",value:function(e,t){e?e.forEach(function(e,t){if(!e.id)throw new w.PSVError("Item ".concat(t,' has no "id".'));if(!e.panorama)throw new w.PSVError("Item ".concat(e.id,' has no "panorama".'))}):e=[],this.handler=t,this.items=e.map(function(e){return{...e,id:"".concat(e.id)}}),this.gallery.setItems(this.items),this.__updateButton()}},{key:"__click",value:function(e){if(e!==this.currentId){if(this.handler)this.handler(e);else{var t=this.items.find(function(t){return t.id===e});this.viewer.setPanorama(t.panorama,{caption:t.name,...t.options})}this.currentId=e,this.gallery.setActive(e),this.config.hideOnClick&&this.hide()}}},{key:"__updateButton",value:function(){var e;null===(e=this.viewer.navbar.getButton(_.id,!1))||void 0===e||e.toggle(this.items.length>0)}}]),t}(w.AbstractConfigurablePlugin);L.id="gallery",L.configParser=M,L.readonlyOptions=["visibleOnLoad","items"],h.DEFAULTS.lang[_.id]="Gallery",(0,h.registerButton)(_,"caption:left"),l(n(e,"__esModule",{value:!0}),u)}),function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports,require("three"),require("@photo-sphere-viewer/core")):"function"==typeof define&&define.amd?define(["exports","three","@photo-sphere-viewer/core"],t):(e="undefined"!=typeof globalThis?globalThis:e||self,t((e.PhotoSphereViewer=e.PhotoSphereViewer||{},e.PhotoSphereViewer.VideoPlugin={}),e.THREE,e.PhotoSphereViewer))}(window,function(e,t,i){function n(e){var t=Math.round(e%60),i=Math.round(e-t)/60;return"".concat(i,":").concat(("0"+t).slice(-2))}var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,l=function(e,t){for(var i in t)r(e,i,{get:t[i],enumerable:!0})},c=function(e,t,i,n){if(t&&"object"===_typeof(t)||"function"==typeof t){var l,c=_createForOfIteratorHelper(a(t));try{var u=function(){var a=l.value;s.call(e,a)||a===i||r(e,a,{get:function(){return t[a]},enumerable:!(n=o(t,a))||n.enumerable})};for(c.s();!(l=c.n()).done;)u()}catch(e){c.e(e)}finally{c.f()}}return e},u=function(){return i},h=function(){return t},d={};l(d,{VideoPlugin:function(){return j},events:function(){return f}});var v=u(),p=u(),f={};l(f,{BufferEvent:function(){return C},PlayPauseEvent:function(){return g},ProgressEvent:function(){return k},VolumeChangeEvent:function(){return w}});var y=u(),m=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.playing=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(y.TypedEvent),g=m;g.type="play-pause";var _=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.volume=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(y.TypedEvent),w=_;w.type="volume-change";var b=function(e){function t(e,n,r){var o;return _classCallCheck(this,t),o=i.call(this,t.type),o.time=e,o.duration=n,o.progress=r,o}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(y.TypedEvent),k=b;k.type="progress";var E=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,t.type),n.maxBuffer=e,n}_inherits(t,e);var i=_createSuper(t);return _createClass(t)}(y.TypedEvent),C=E;C.type="buffer";var T='<svg viewBox="80 10 540 540" xmlns="http://www.w3.org/2000/svg"><path d="M80.58 279.67c0-148.76 120.33-269.09 269.09-269.09s269.75 120.33 269.75 269.09-121 269.75-269.75 269.75-269.1-120.99-269.1-269.75zm175.87 105.12V175.2c0-9.26 7.27-15.87 15.86-15.87h39.01c8.6 0 15.87 6.62 15.87 15.87v209.59c0 8.6-7.27 15.87-15.87 15.87h-39c-8.6 0-15.87-7.28-15.87-15.87zm116.36 0V175.2c0-9.26 7.27-15.87 15.86-15.87h38.35c9.26 0 15.87 6.62 15.87 15.87v209.59c0 8.6-6.61 15.87-15.87 15.87h-38.34c-8.6 0-15.87-7.28-15.87-15.87z" fill-rule="evenodd" fill="currentcolor"/></svg>',S='<svg viewBox="76 5 550 550" xmlns="http://www.w3.org/2000/svg"><path fill="currentcolor" d="M351.1 5.6A274.1 274.1 0 0 0 76.7 280a274.1 274.1 0 0 0 274.4 274.4A274.1 274.1 0 0 0 625.5 280 274.1 274.1 0 0 0 351.1 5.6zm146.7 282.8-219 134.4c-6.6 4-15.6-.6-15.6-8.4V145.6c0-7.8 9-12.9 15.7-8.4l219 134.4a10 10 0 0 1 0 16.8z"/></svg>',P=function(e){function t(e){var n,r;return _classCallCheck(this,t),r=i.call(this,e,{className:"psv-video-play-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:S,iconActive:T}),r.plugin=r.viewer.getPlugin("video"),null===(n=r.plugin)||void 0===n||n.addEventListener(g.type,_assertThisInitialized(r)),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){var e;null===(e=this.plugin)||void 0===e||e.removeEventListener(g.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"isSupported",value:function(){return!!this.plugin}},{key:"handleEvent",value:function(e){_instanceof(e,g)&&this.toggleActive(e.playing)}},{key:"onClick",value:function(){this.plugin.playPause()}}]),t}(p.AbstractButton);P.id="videoPlay",P.groupId="video";var O=u(),M=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-caption psv-video-time",hoverScale:!1,collapsable:!1,tabbable:!1}),n.contentElt=document.createElement("div"),n.contentElt.className="psv-caption-content",n.container.appendChild(n.contentElt),n.plugin=n.viewer.getPlugin("video"),n.plugin&&(n.viewer.addEventListener(O.events.PanoramaLoadedEvent.type,_assertThisInitialized(n)),n.plugin.addEventListener(k.type,_assertThisInitialized(n))),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.plugin&&(this.viewer.removeEventListener(O.events.PanoramaLoadedEvent.type,this),this.plugin.removeEventListener(k.type,this)),delete this.plugin,_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){switch(e.type){case O.events.PanoramaLoadedEvent.type:case k.type:this.contentElt.innerHTML="<strong>".concat(n(this.plugin.getTime()),"</strong> / ").concat(n(this.plugin.getDuration()))}}},{key:"onClick",value:function(){}}]),t}(O.AbstractButton);M.id="videoTime",M.groupId="video";var L=u(),x='<svg xmlns="http://www.w3.org/2000/svg" viewBox="17 16 71 71"><path fill="currentColor" d="M20.19 61.66H32.9c.54 0 1.07.16 1.52.47L51.02 73.5a2.7 2.7 0 0 0 4.22-2.23V28.74a2.7 2.7 0 0 0-4.22-2.23L34.43 37.87c-.45.3-.98.47-1.52.47H20.19a2.7 2.7 0 0 0-2.7 2.7v17.92a2.7 2.7 0 0 0 2.7 2.7z"/><path id="lvl0" fill="currentColor" d="M63.802 58.834c.39.39.902.586 1.414.586s1.023-.195 1.414-.586l7.234-7.233 7.234 7.233c.39.39.902.586 1.414.586s1.023-.195 1.414-.586a2 2 0 0 0 0-2.828l-7.234-7.234 7.234-7.233a2 2 0 1 0-2.828-2.828l-7.234 7.233-7.234-7.233a2 2 0 1 0-2.828 2.828l7.234 7.233-7.234 7.234a2 2 0 0 0 0 2.828z"/><path id="lvl1" fill="currentColor" d="M59.573 59.65c.39.394.904.59 1.418.59.51 0 1.02-.194 1.41-.582A13.53 13.53 0 0 0 66.411 50a13.56 13.56 0 0 0-3.996-9.654 2 2 0 0 0-2.828 2.829A9.586 9.586 0 0 1 62.41 50a9.56 9.56 0 0 1-2.83 6.823 2 2 0 0 0-.008 2.828z"/><path id="lvl2" fill="currentColor" d="M72.501 50c0 5.267-2.055 10.227-5.786 13.967a2 2 0 0 0 2.832 2.825C74.03 62.297 76.5 56.333 76.5 50s-2.47-12.297-6.954-16.792a2 2 0 0 0-2.832 2.825c3.731 3.74 5.786 8.7 5.786 13.967z"/><path id="lvl3" fill="currentColor" d="M83.001 50c0 8.084-3.147 15.679-8.863 21.384a2 2 0 0 0 2.826 2.831C83.437 67.754 87 59.155 87 50c0-9.154-3.564-17.753-10.037-24.215a2 2 0 0 0-2.826 2.83C79.854 34.323 83 41.917 83 50z"/><!--Created by Rudez Studio from the Noun Project--></svg>',I=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e,{className:"psv-video-volume-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:x}),n.plugin=n.viewer.getPlugin("video"),n.plugin&&(n.rangeContainer=document.createElement("div"),n.rangeContainer.className="psv-video-volume__container",n.container.appendChild(n.rangeContainer),n.range=document.createElement("div"),n.range.className="psv-video-volume__range",n.rangeContainer.appendChild(n.range),n.trackElt=document.createElement("div"),n.trackElt.className="psv-video-volume__track",n.range.appendChild(n.trackElt),n.progressElt=document.createElement("div"),n.progressElt.className="psv-video-volume__progress",n.range.appendChild(n.progressElt),n.handleElt=document.createElement("div"),n.handleElt.className="psv-video-volume__handle",n.range.appendChild(n.handleElt),n.slider=new L.utils.Slider(n.range,L.utils.SliderDirection.VERTICAL,n.__onSliderUpdate.bind(_assertThisInitialized(n))),n.viewer.addEventListener(L.events.PanoramaLoadedEvent.type,_assertThisInitialized(n)),n.plugin.addEventListener(g.type,_assertThisInitialized(n)),n.plugin.addEventListener(w.type,_assertThisInitialized(n)),n.__setVolume(0)),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.plugin&&(this.viewer.removeEventListener(L.events.PanoramaLoadedEvent.type,this),this.plugin.removeEventListener(g.type,this),this.plugin.removeEventListener(w.type,this)),this.slider.destroy(),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"isSupported",value:function(){return!!this.plugin}},{key:"handleEvent",value:function(e){switch(e.type){case L.events.PanoramaLoadedEvent.type:case g.type:case w.type:this.__setVolume(this.plugin.getVolume())}}},{key:"onClick",value:function(){this.plugin.setMute()}},{key:"__onSliderUpdate",value:function(e){e.mousedown&&this.plugin.setVolume(e.value)}},{key:"__setVolume",value:function(e){var t;t=0===e?0:e<.333?1:e<.666?2:3,L.utils.toggleClass(this.container,"psv-video-volume-button--0",0===t),L.utils.toggleClass(this.container,"psv-video-volume-button--1",1===t),L.utils.toggleClass(this.container,"psv-video-volume-button--2",2===t),L.utils.toggleClass(this.container,"psv-video-volume-button--3",3===t),this.handleElt.style.bottom="".concat(100*e,"%"),this.progressElt.style.height="".concat(100*e,"%")}}]),t}(L.AbstractButton);I.id="videoVolume",I.groupId="video";var z=u(),A=h(),R=u(),H=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,n,{className:"psv-video-overlay"}),r.plugin=e,r.button=document.createElement("button"),r.button.className="psv-video-bigbutton ".concat(R.CONSTANTS.CAPTURE_EVENTS_CLASS),r.button.innerHTML=S,r.container.appendChild(r.button),r.viewer.addEventListener(R.events.PanoramaLoadedEvent.type,_assertThisInitialized(r)),r.plugin.addEventListener(g.type,_assertThisInitialized(r)),r.button.addEventListener("click",_assertThisInitialized(r)),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.viewer.removeEventListener(R.events.PanoramaLoadedEvent.type,this),this.plugin.removeEventListener(g.type,this),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){switch(e.type){case R.events.PanoramaLoadedEvent.type:case g.type:R.utils.toggleClass(this.button,"psv-video-bigbutton--pause",!this.plugin.isPlaying());break;case"click":this.plugin.playPause()}}}]),t}(R.AbstractComponent),N=u(),V=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,n,{className:"psv-video-progressbar"}),r.plugin=e,r.state={visible:!0,req:null,tooltip:null},r.bufferElt=document.createElement("div"),r.bufferElt.className="psv-video-progressbar__buffer",r.container.appendChild(r.bufferElt),r.progressElt=document.createElement("div"),r.progressElt.className="psv-video-progressbar__progress",r.container.appendChild(r.progressElt),r.handleElt=document.createElement("div"),r.handleElt.className="psv-video-progressbar__handle",
r.container.appendChild(r.handleElt),r.slider=new N.utils.Slider(r.container,N.utils.SliderDirection.HORIZONTAL,r.__onSliderUpdate.bind(_assertThisInitialized(r))),r.viewer.addEventListener(N.events.PanoramaLoadedEvent.type,_assertThisInitialized(r)),r.plugin.addEventListener(C.type,_assertThisInitialized(r)),r.plugin.addEventListener(k.type,_assertThisInitialized(r)),r.state.req=window.requestAnimationFrame(function(){return r.__updateProgress()}),r.hide(),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){var e;this.viewer.removeEventListener(N.events.PanoramaLoadedEvent.type,this),this.plugin.removeEventListener(C.type,this),this.plugin.removeEventListener(k.type,this),this.slider.destroy(),null===(e=this.state.tooltip)||void 0===e||e.hide(),window.cancelAnimationFrame(this.state.req),delete this.state.tooltip,_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){switch(e.type){case N.events.PanoramaLoadedEvent.type:case C.type:case k.type:this.bufferElt.style.width="".concat(100*this.plugin.getBufferProgress(),"%")}}},{key:"__updateProgress",value:function(){var e=this;this.progressElt.style.width="".concat(100*this.plugin.getProgress(),"%"),this.state.req=window.requestAnimationFrame(function(){return e.__updateProgress()})}},{key:"__onSliderUpdate",value:function(e){if(e.mouseover){this.handleElt.style.display="block",this.handleElt.style.left="".concat(100*e.value,"%");var t=n(this.plugin.getDuration()*e.value);this.state.tooltip?this.state.tooltip.update(t,{top:e.cursor.clientY,left:e.cursor.clientX}):this.state.tooltip=this.viewer.createTooltip({top:e.cursor.clientY,left:e.cursor.clientX,content:t})}else{var i;this.handleElt.style.display="none",null===(i=this.state.tooltip)||void 0===i||i.hide(),delete this.state.tooltip}e.click&&this.plugin.setProgress(e.value)}}]),t}(N.AbstractComponent),D=z.utils.getConfigParser({progressbar:!0,bigbutton:!0,keypoints:null}),j=function(e){function t(e,n){var r;if(_classCallCheck(this,t),r=i.call(this,e,n),r.state={curve:null,start:null,end:null,keypoints:null},!r.viewer.adapter.constructor.id.includes("video"))throw new z.PSVError("VideoPlugin can only be used with a video adapter.");return r.config.progressbar&&(r.progressbar=new V(_assertThisInitialized(r),e)),r.config.bigbutton&&(r.overlay=new H(_assertThisInitialized(r),e)),r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"init",value:function(){var e;_get(_getPrototypeOf(t.prototype),"init",this).call(this),this.markers=this.viewer.getPlugin("markers"),this.autorotate=this.viewer.getPlugin("autorotate"),this.autorotate&&(this.autorotate.config.autostartDelay=0,this.autorotate.config.autostartOnIdle=!1),this.config.keypoints&&(this.setKeypoints(this.config.keypoints),delete this.config.keypoints),null===(e=this.autorotate)||void 0===e||e.addEventListener("autorotate",this),this.viewer.addEventListener(z.events.BeforeRenderEvent.type,this),this.viewer.addEventListener(z.events.PanoramaLoadedEvent.type,this),this.viewer.addEventListener(z.events.KeypressEvent.type,this)}},{key:"destroy",value:function(){var e;null===(e=this.autorotate)||void 0===e||e.removeEventListener("autorotate",this),this.viewer.removeEventListener(z.events.BeforeRenderEvent.type,this),this.viewer.removeEventListener(z.events.PanoramaLoadedEvent.type,this),this.viewer.removeEventListener(z.events.KeypressEvent.type,this),delete this.progressbar,delete this.overlay,delete this.markers,_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){var t;switch(e.type){case z.events.BeforeRenderEvent.type:this.__autorotate();break;case"autorotate":this.__configureAutorotate();break;case z.events.PanoramaLoadedEvent.type:this.__bindVideo(e.data),null===(t=this.progressbar)||void 0===t||t.show();break;case z.events.KeypressEvent.type:this.__onKeyPress(e);break;case"play":case"pause":this.dispatchEvent(new g(this.isPlaying()));break;case"progress":this.dispatchEvent(new C(this.getBufferProgress()));break;case"volumechange":this.dispatchEvent(new w(this.getVolume()));break;case"timeupdate":this.dispatchEvent(new k(this.getTime(),this.getDuration(),this.getProgress()))}}},{key:"__bindVideo",value:function(e){this.video&&(this.video.removeEventListener("play",this),this.video.removeEventListener("pause",this),this.video.removeEventListener("progress",this),this.video.removeEventListener("volumechange",this),this.video.removeEventListener("timeupdate",this)),this.video=e.texture.image,this.video.addEventListener("play",this),this.video.addEventListener("pause",this),this.video.addEventListener("progress",this),this.video.addEventListener("volumechange",this),this.video.addEventListener("timeupdate",this)}},{key:"__onKeyPress",value:function(e){e.key===z.CONSTANTS.KEY_CODES.Space&&(this.playPause(),e.preventDefault())}},{key:"getDuration",value:function(){var e,t;return null!==(e=null===(t=this.video)||void 0===t?void 0:t.duration)&&void 0!==e?e:0}},{key:"getTime",value:function(){var e,t;return null!==(e=null===(t=this.video)||void 0===t?void 0:t.currentTime)&&void 0!==e?e:0}},{key:"getProgress",value:function(){return this.video?this.video.currentTime/this.video.duration:0}},{key:"isPlaying",value:function(){return!!this.video&&!this.video.paused}},{key:"getVolume",value:function(){var e,t,i;return null!==(e=this.video)&&void 0!==e&&e.muted?0:null!==(t=null===(i=this.video)||void 0===i?void 0:i.volume)&&void 0!==t?t:0}},{key:"playPause",value:function(){this.video&&(this.video.paused?this.video.play():this.video.pause())}},{key:"play",value:function(){var e;null!==(e=this.video)&&void 0!==e&&e.paused&&this.video.play()}},{key:"pause",value:function(){this.video&&!this.video.paused&&this.video.pause()}},{key:"setVolume",value:function(e){this.video&&(this.video.muted=!1,this.video.volume=A.MathUtils.clamp(e,0,1))}},{key:"setMute",value:function(e){this.video&&(this.video.muted=void 0===e?!this.video.muted:e,this.video.muted||0!==this.video.volume||(this.video.volume=.1))}},{key:"setTime",value:function(e){this.video&&(this.video.currentTime=e)}},{key:"setProgress",value:function(e){this.video&&(this.video.currentTime=this.video.duration*e)}},{key:"getBufferProgress",value:function(){if(this.video){for(var e=0,t=this.video.buffered,i=0,n=t.length;i<n;i++)if(t.start(i)<=this.video.currentTime&&t.end(i)>=this.video.currentTime){e=t.end(i);break}return Math.max(this.video.currentTime,e)/this.video.duration}return 0}},{key:"setKeypoints",value:function(e){var t=this;if(!this.autorotate)throw new z.PSVError("Video keypoints required the AutorotatePlugin");if(!e)return this.state.keypoints=null,void this.__configureAutorotate();if(e.length<2)throw new z.PSVError("At least two points are required");this.state.keypoints=z.utils.clone(e),this.state.keypoints&&(this.state.keypoints.forEach(function(e,i){if(!e.position)throw new z.PSVError("Keypoint #".concat(i," is missing marker or position"));if(e.position=t.viewer.dataHelper.cleanPosition(e.position),z.utils.isNil(e.time))throw new z.PSVError("Keypoint #".concat(i," is missing time"))}),this.state.keypoints.sort(function(e,t){return e.time-t.time})),this.__configureAutorotate()}},{key:"__configureAutorotate",value:function(){delete this.state.curve,delete this.state.start,delete this.state.end,this.autorotate.isEnabled()&&this.state.keypoints&&this.viewer.dynamics.position.stop()}},{key:"__autorotate",value:function(){var e;if(null!==(e=this.autorotate)&&void 0!==e&&e.isEnabled()&&this.state.keypoints){var t=this.getTime(),i=this.state;if((!i.curve||t<i.start.time||t>=i.end.time)&&this.__autorotateNext(t),i.start===i.end)this.viewer.rotate(i.start.position);else{var n=(t-i.start.time)/(i.end.time-i.start.time),r=i.curve.getPoint(1/3+n/3);this.viewer.dynamics.position.goto({yaw:r.x,pitch:r.y})}}}},{key:"__autorotateNext",value:function(e){var t=null,i=null,n=this.state.keypoints,r=n.length-1;e<n[0].time&&(t=0,i=0);for(var o=0;o<r;o++)if(e>=n[o].time&&e<n[o+1].time){t=o,i=o+1;break}e>=n[r].time&&(t=r,i=r);for(var a=[n[Math.max(0,t-1)].position,n[t].position,n[i].position,n[Math.min(r,i+1)].position],s=[new A.Vector2(a[0].yaw,a[0].pitch)],l=0,c=1;c<=3;c++){var u=a[c-1].yaw-a[c].yaw;u>Math.PI?l+=1:u<-Math.PI&&(l-=1),0!==l&&1===c&&(s[0].x-=2*l*Math.PI,l=0),s.push(new A.Vector2(a[c].yaw+2*l*Math.PI,a[c].pitch))}this.state.curve=new A.SplineCurve(s),this.state.start=n[t],this.state.end=n[i]}}]),t}(z.AbstractConfigurablePlugin);j.id="video",j.configParser=D,j.readonlyOptions=Object.keys(D.defaults),v.DEFAULTS.lang[P.id]="Play/Pause",v.DEFAULTS.lang[I.id]="Volume",(0,v.registerButton)(P),(0,v.registerButton)(I),(0,v.registerButton)(M),v.DEFAULTS.navbar.unshift(P.groupId),c(r(e,"__esModule",{value:!0}),d)}),function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports,require("three"),require("@photo-sphere-viewer/core")):"function"==typeof define&&define.amd?define(["exports","three","@photo-sphere-viewer/core"],t):(e="undefined"!=typeof globalThis?globalThis:e||self,t((e.PhotoSphereViewer=e.PhotoSphereViewer||{},e.PhotoSphereViewer.EquirectangularVideoAdapter={}),e.THREE,e.PhotoSphereViewer))}(window,function(e,t,i){var n=Object.defineProperty,r=Object.getOwnPropertyDescriptor,o=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,s=function(e,t){for(var i in t)n(e,i,{get:t[i],enumerable:!0})},l=function(e,t,i,s){if(t&&"object"===_typeof(t)||"function"==typeof t){var l,c=_createForOfIteratorHelper(o(t));try{var u=function(){var o=l.value;a.call(e,o)||o===i||n(e,o,{get:function(){return t[o]},enumerable:!(s=r(t,o))||s.enumerable})};for(c.s();!(l=c.n()).done;)u()}catch(e){c.e(e)}finally{c.f()}}return e},c=function(){return i},u=function(){return t},h={};s(h,{EquirectangularVideoAdapter:function(){return g}});var d=c(),v=u(),p=c(),f=u(),y=function(e){function t(e){var n;return _classCallCheck(this,t),n=i.call(this,e),n.viewer.addEventListener(p.events.BeforeRenderEvent.type,_assertThisInitialized(n)),n}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"destroy",value:function(){this.viewer.removeEventListener(p.events.BeforeRenderEvent.type,this),this.__removeVideo(),_get(_getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"handleEvent",value:function(e){_instanceof(e,p.events.BeforeRenderEvent)&&this.viewer.needsUpdate()}},{key:"supportsPreload",value:function(){return!1}},{key:"supportsTransition",value:function(){return!1}},{key:"loadTexture",value:function(e){if("object"!==_typeof(e)||!e.source)return Promise.reject(new p.PSVError("Invalid panorama configuration, are you using the right adapter?"));if(!this.viewer.getPlugin("video"))return Promise.reject(new p.PSVError("Video adapters require VideoPlugin to be loaded too."));var t=this.__createVideo(e.source);return this.__videoLoadPromise(t).then(function(){var i=new f.VideoTexture(t);return{panorama:e,texture:i}})}},{key:"switchVideo",value:function(e){var t,i,n=!this.config.autoplay,r=this.config.muted,o=1;if(this.video){var a=this.video;t=a.currentTime,i=a.duration,n=a.paused,r=a.muted,o=a.volume}this.__removeVideo(),this.video=e.image,this.video.duration===i&&(this.video.currentTime=t),this.video.muted=r,this.video.volume=o,n||this.video.play()}},{key:"setTextureOpacity",value:function(e,t){e.material.opacity=t,e.material.transparent=t<1}},{key:"setOverlay",value:function(){throw new p.PSVError("VideoAdapter does not support overlay")}},{key:"disposeTexture",value:function(e){var t;if(e.texture){var i=e.texture.image;i.pause(),this.viewer.container.removeChild(i)}null===(t=e.texture)||void 0===t||t.dispose()}},{key:"__removeVideo",value:function(){this.video&&(this.video.pause(),this.viewer.container.removeChild(this.video),delete this.video)}},{key:"__createVideo",value:function(e){var t=document.createElement("video");return t.crossOrigin=this.viewer.config.withCredentials?"use-credentials":"anonymous",t.loop=!0,t.playsInline=!0,t.style.display="none",t.muted=this.config.muted,t.src=e,t.preload="metadata",this.viewer.container.appendChild(t),t}},{key:"__videoLoadPromise",value:function(e){var t=this;return new Promise(function(i,n){var r=function n(){t.video&&e.duration===t.video.duration?i(t.__videoBufferPromise(e,t.video.currentTime)):i(),e.removeEventListener("loadedmetadata",n)},o=function t(i){n(i),e.removeEventListener("error",t)};e.addEventListener("loadedmetadata",r),e.addEventListener("error",o)})}},{key:"__videoBufferPromise",value:function(e,t){return new Promise(function(i){function n(){for(var t=e.buffered,r=0,o=t.length;r<o;r++)if(t.start(r)<=e.currentTime&&t.end(r)>=e.currentTime){e.pause(),e.removeEventListener("buffer",n),e.removeEventListener("progress",n),i();break}}e.currentTime=Math.min(t+2e3,e.duration),e.muted=!0,e.addEventListener("buffer",n),e.addEventListener("progress",n),e.play()})}}]),t}(p.AbstractAdapter);y.supportsDownload=!1,y.supportsOverlay=!1;var m=d.utils.getConfigParser({resolution:64,autoplay:!1,muted:!1,blur:!1},{resolution:function(e){if(!e||!v.MathUtils.isPowerOfTwo(e))throw new d.PSVError("EquirectangularTilesAdapter resolution must be power of two");return e}}),g=function(e){function t(e,n){var r;return _classCallCheck(this,t),r=i.call(this,e),r.config=m(n),r.SPHERE_SEGMENTS=r.config.resolution,r.SPHERE_HORIZONTAL_SEGMENTS=r.SPHERE_SEGMENTS/2,r}_inherits(t,e);var i=_createSuper(t);return _createClass(t,[{key:"loadTexture",value:function(e){return _get(_getPrototypeOf(t.prototype),"loadTexture",this).call(this,e).then(function(t){var i=t.texture,n=i.image,r={fullWidth:n.videoWidth,fullHeight:n.videoHeight,croppedWidth:n.videoWidth,croppedHeight:n.videoHeight,croppedX:0,croppedY:0,poseHeading:0,posePitch:0,poseRoll:0};return{panorama:e,texture:i,panoData:r}})}},{key:"createMesh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=new v.SphereGeometry(d.CONSTANTS.SPHERE_RADIUS*e,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS,-Math.PI/2).scale(-1,1,1),i=new v.MeshBasicMaterial;return new v.Mesh(t,i)}},{key:"setTexture",value:function(e,t){var i;null===(i=e.material.map)||void 0===i||i.dispose(),e.material.map=t.texture,this.switchVideo(t.texture)}}]),t}(y);g.id="equirectangular-video",l(n(e,"__esModule",{value:!0}),h)});